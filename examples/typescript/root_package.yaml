# yaml-language-server: $schema=../../schemas/development.json

# ANCHOR: all
typescript:
  # By default, typescript and oxlint would be added to
  # the root package's dependencies
  no_default_deps: true

  # Pnpm is the default, and if selected, it will generate
  # a pnpm-workspace.yaml file
  package_manager: pnpm

  # ANCHOR: pnpm
  # Customized configuration for `pnpm-workspace.yaml`
  pnpm:
    # All the dirs listed here will be created automatically
    # when new monorepos are created
    packages:
      - packages/*
      - apps/*
    onlyBuiltDependencies:
      - esbuild
    minimumReleaseAge: 1440
  # ANCHOR_END: pnpm

  package_presets:
    # Defining a preset for the root package
    root:
      name: workspace

      package_json:
        license: Apache-2.0
        devDependencies:
          husky: ^9.0.0

      # The tsconfig files to generate at the root.
      # If left empty, defaults will be used.
      ts_config:
        - output: tsconfig.options.json
          config:
            compilerOptions:
              verbatimModuleSyntax: true
              strict: true

        - output: tsconfig.json
          config:
            files: []

      # Literal oxlint configuration to generate at the root
      # of the workspace.
      # Can be set to `true` to use defaults.
      oxlint:
        plugins: ["unicorn", "typescript", "oxc"]
      # ANCHOR_END: all

      # ANCHOR: template_example
      with_templates:
        # Relative path from the root of the package
        - output: docker/dev.dockerfile
          template:
            name: dev_dockerfile
            content: |
              FROM node:23-alpine

              COPY . .
              EXPOSE {{ docker_dev_port }}
              CMD ["npm", "run", "dev"]

vars:
  docker_dev_port: 5173
  # ANCHOR_END: template_example
