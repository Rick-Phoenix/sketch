<!DOCTYPE HTML>
<html lang="en" class="mocha sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Sketch</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="./theme/catppuccin.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "mocha";
            const default_dark_theme = "mocha";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>‚Üê</kbd> or <kbd>‚Üí</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('mocha')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="latte">Latte</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="frappe">Frapp√©</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="macchiato">Macchiato</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mocha">Mocha</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Sketch</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/Rick-Phoenix/sketch" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="-sketch"><a class="header" href="#-sketch">üñåÔ∏è Sketch</a></h1>
<p>Sketch is a tool designed to <strong>reduce boilerplate</strong>, <strong>increase productivity</strong>, and facilitate the creation and management of <strong>structured</strong> and <strong>easily reproducible</strong> workspaces.</p>
<p><strong>Table of contents</strong></p>
<ul>
<li><a href="index.html#goals-and-design-philosophy">Goals And Design Philosophy</a>
<ul>
<li><a href="index.html#presets">Presets</a></li>
<li><a href="index.html#why-use-presets">Why Use Presets</a></li>
<li><a href="index.html#supported-presets">Supported Presets</a></li>
<li><a href="index.html#enhanced-templating-toolset">Enhanced Templating Toolset</a></li>
</ul>
</li>
<li><a href="index.html#installation">Installation</a></li>
<li><a href="index.html#documentation">Documentation</a></li>
</ul>
<h2 id="goals-and-design-philosophy"><a class="header" href="#goals-and-design-philosophy">Goals And Design Philosophy</a></h2>
<p>Templating is mostly used to render webpages, but it can also be used to generate files used in day-to-day development, and even more, it can be used to define structures for entire projects in a way that can be <strong>standardized</strong> enough to provide structure and clarity, but also <strong>flexible</strong> enough as to make use of customized or even dynamically generated parameters.</p>
<p>While templating is a powerful technology on its own, it needs a frontend, a <em>framework</em> of sort, to make use of its flexible toolset, enhance it with with extra features, and to wrap it with an <strong>ergonomic</strong> API explicitely designed with the intent of simplifying most if not all activities related to creating and managing files and projects.</p>
<p>This is that Sketch aims to be, and it all starts with the concept of <code>preset</code>.</p>
<h3 id="presets"><a class="header" href="#presets">Presets</a></h3>
<p>The basic concept about presets is that you should be able to define specific configurations that you find yourself using very often, and then use them to generate the files that you need or as the base for a more detailed preset.</p>
<p>Presets come in different forms and shapes and with different features.</p>
<p>Some presets are used as a way to <strong>aggregate</strong> other presets or templates into a single structure. For example, a git <code>repo</code> preset can use a <code>gitignore</code> or a <code>pre-commit</code> preset, it can aggregate customized templates templates to render inside the new repo, and it can also contain a list of commands (which also benefit from templating features) to execute before or after generation.</p>
<p>Other presets, such as those that belong to some of the most widely used configuration files such as Rust's <code>Cargo.toml</code>, or Typescript's <code>tsconfig.json</code>, are <strong>fully typed</strong> and documented (as part of the JSON schema for Sketch's configuration file), so that defining them comes with all of the benefits of IDE integration such as <strong>type safety</strong> and <strong>autocompletion</strong>.</p>
<p>Other presets are <strong>extensible</strong>, which means that you can define a <em>base</em> preset containing some common data (such as a list of networks or volumes in a <code>compose.yaml</code> file or a list of dependencies in a <code>package.json</code> file), and then create a preset that <strong>extends</strong> that base preset, so that you do not need to repeat inputs for all presets that share common settings.</p>
<h3 id="why-use-presets"><a class="header" href="#why-use-presets">Why Use Presets</a></h3>
<p>Using presets helps in dealing with some of the most common pain points in software development:</p>
<h4 id="1-boilerplate-generation"><a class="header" href="#1-boilerplate-generation">1. <strong>Boilerplate Generation</strong></a></h4>
<h5 id="the-problem"><a class="header" href="#the-problem">The Problem</a></h5>
<p>Writing boilerplate is an unrewarding and time consuming process. It causes unwanted cognitive load and kills productive momentum.</p>
<h5 id="the-solution"><a class="header" href="#the-solution">The Solution</a></h5>
<p>When using presets, a single command can be used to generate a file or an entire project structure. It's orders of magnitude faster than doing it manually, while still being less complex than creating an ad-hoc script and more flexible than mere copy-pasting.</p>
<h4 id="2-structure-and-reproducibility"><a class="header" href="#2-structure-and-reproducibility">2. Structure And Reproducibility</a></h4>
<h5 id="the-problem-1"><a class="header" href="#the-problem-1">The Problem</a></h5>
<p>There are many cases in which you need to use a configuration file in multiple projects, such as a <code>compose.yaml</code> file, a github workflow, a setup file for a formatter or action runner, and so on. And chances are, you want to use this exact configuration in many if not all of your projects.</p>
<p>When you need to update this configuration file, you then need to update it in every other place where you are using it.
If this is done manually, each copy may look slightly different than the other even for something as simple as ordering fields in a different way from one file to another.</p>
<p>While this may seem trivial, it causes mental friction and it can compound to outright confusion because each time your brain has to process a slightly different structure.</p>
<h5 id="the-solution-1"><a class="header" href="#the-solution-1">The Solution</a></h5>
<p>If you use a preset, then every file generated with that preset will look the exact same. It removes the cognitive penalty caused by ever-slightly-different configuration files, and lets you focus on more important areas of your work.</p>
<p>And with extensible presets, you can keep a core preset where you define all of your shared configurations, and then extend it with more customized settings based on your project's needs.</p>
<h4 id="3-maintainability"><a class="header" href="#3-maintainability">3. Maintainability</a></h4>
<h5 id="the-problem-2"><a class="header" href="#the-problem-2">The Problem</a></h5>
<p>When you need to use a specific configuration in many different projects, that means that every change must be applied to every instance of the same configuration. This is a tedious and error-prone process, that eventually leads to projects being misconfigured and requiring manual review to bring them up to date with the new settings.</p>
<h5 id="the-solution-2"><a class="header" href="#the-solution-2">The Solution</a></h5>
<p>With a preset, you can modify the preset itself and then update each instance programmatically (either by reusing or extending another preset). Even if the new changes are very specific and need manual review rather than being immediately applicable everywhere, it's still easier to maintain 1 preset (or even 2 or 10, for that matter) than maintaining 100s of individual files.</p>
<h3 id="supported-presets"><a class="header" href="#supported-presets">Supported Presets</a></h3>
<p>The list of supported presets includes:</p>
<ul>
<li>
<p>Git</p>
<ul>
<li><code>.gitignore</code> (extensible)</li>
<li><code>.pre-commit-config.yaml</code> (extensible)</li>
<li><a href="https://docs.github.com/en/actions/reference/workflows-and-actions/workflow-syntax">Github workflow</a> (extensible)</li>
<li><a href="https://docs.github.com/en/actions/reference/workflows-and-actions/workflow-syntax#jobs">Github workflow job</a> (extensible)</li>
</ul>
</li>
<li>
<p>Docker</p>
<ul>
<li>Docker Compose file (extensible)</li>
<li>Docker Compose service (extensible)</li>
</ul>
</li>
<li>
<p>Rust</p>
<ul>
<li><code>Cargo.toml</code> (extensible)</li>
</ul>
</li>
<li>
<p>Typescript</p>
<ul>
<li><code>pnpm-workspace.yaml</code> (extensible)</li>
<li><code>package.json</code> (extensible, with extra features)</li>
<li><code>tsconfig.json</code> (extensible, with merging of values for the <code>references</code>, <code>include</code>, <code>exclude</code> and <code>files</code> fields)</li>
<li><code>.oxlintrc.json</code> (extensible)</li>
<li><code>vitest</code> (not a full configuration for <code>vitest.config.ts</code>, but a basic testing setup)</li>
</ul>
</li>
</ul>
<h3 id="enhanced-templating-toolset"><a class="header" href="#enhanced-templating-toolset">Enhanced Templating Toolset</a></h3>
<p>While presets are designed to cover some of the most common use cases, <code>custom templates</code> can also be used to cover all sorts of scenarios. Custom templates can then be aggregated and used by other presets.</p>
<p>Sketch uses <a href="https://keats.github.io/tera/docs/">Tera</a> as the templating engine to render custom templates, enhanced with a variety of extra features, such as:</p>
<ul>
<li><strong>Special variables</strong> that extract commonly used values such as the user directory or the host's operating system</li>
<li><strong>Functions</strong> that perform actions such as:
<ul>
<li>Making a glob search in a directory</li>
<li>Generating a uuid</li>
<li>Transforming a relative path into an absolute path</li>
<li>Extracting capture groups from a regex</li>
</ul>
</li>
</ul>
<p>...and many other more, which you can find out about in more detail in the <a href="https://rick-phoenix.github.io/sketch/">dedicated website</a>.</p>
<h2 id="installation"><a class="header" href="#installation">Installation</a></h2>
<p>Sketch can be installed in two ways:</p>
<ol>
<li>By downloading a pre-built binary from the <a href="https://github.com/Rick-Phoenix/sketch">github repository</a></li>
<li>Via <code>cargo</code> (<code>cargo install sketch-it</code>)</li>
</ol>
<h2 id="documentation"><a class="header" href="#documentation">Documentation</a></h2>
<p>You can find out more about Sketch in the <a href="https://rick-phoenix.github.io/sketch/">dedicated website</a>.</p>
<p>The homepage will always show the docs for the latest version. Each minor version will have its own dedicated subroute under <code>/versions</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="command-line-help-for-sketch"><a class="header" href="#command-line-help-for-sketch">Command-Line Help for <code>sketch</code></a></h1>
<p>This document contains the help content for the <code>sketch</code> command-line program.</p>
<p><strong>Command Overview:</strong></p>
<ul>
<li><a href="cli_docs.html#sketch"><code>sketch</code>‚Ü¥</a></li>
<li><a href="cli_docs.html#sketch-new"><code>sketch new</code>‚Ü¥</a></li>
<li><a href="cli_docs.html#sketch-repo"><code>sketch repo</code>‚Ü¥</a></li>
<li><a href="cli_docs.html#sketch-render"><code>sketch render</code>‚Ü¥</a></li>
<li><a href="cli_docs.html#sketch-render-preset"><code>sketch render-preset</code>‚Ü¥</a></li>
<li><a href="cli_docs.html#sketch-exec"><code>sketch exec</code>‚Ü¥</a></li>
<li><a href="cli_docs.html#sketch-gitignore"><code>sketch gitignore</code>‚Ü¥</a></li>
<li><a href="cli_docs.html#sketch-gh-workflow"><code>sketch gh-workflow</code>‚Ü¥</a></li>
<li><a href="cli_docs.html#sketch-docker-compose"><code>sketch docker-compose</code>‚Ü¥</a></li>
<li><a href="cli_docs.html#sketch-pre-commit"><code>sketch pre-commit</code>‚Ü¥</a></li>
<li><a href="cli_docs.html#sketch-cargo-toml"><code>sketch cargo-toml</code>‚Ü¥</a></li>
<li><a href="cli_docs.html#sketch-ts"><code>sketch ts</code>‚Ü¥</a></li>
<li><a href="cli_docs.html#sketch-ts-monorepo"><code>sketch ts monorepo</code>‚Ü¥</a></li>
<li><a href="cli_docs.html#sketch-ts-package"><code>sketch ts package</code>‚Ü¥</a></li>
<li><a href="cli_docs.html#sketch-ts-barrel"><code>sketch ts barrel</code>‚Ü¥</a></li>
<li><a href="cli_docs.html#sketch-package-json"><code>sketch package-json</code>‚Ü¥</a></li>
<li><a href="cli_docs.html#sketch-ts-config"><code>sketch ts-config</code>‚Ü¥</a></li>
<li><a href="cli_docs.html#sketch-oxlint"><code>sketch oxlint</code>‚Ü¥</a></li>
<li><a href="cli_docs.html#sketch-pnpm-workspace"><code>sketch pnpm-workspace</code>‚Ü¥</a></li>
<li><a href="cli_docs.html#sketch-license"><code>sketch license</code>‚Ü¥</a></li>
</ul>
<h2 id="sketch"><a class="header" href="#sketch"><code>sketch</code></a></h2>
<p>üñåÔ∏è Templating made simple. A tool to define and generate files and reusable project structures</p>
<p><strong>Usage:</strong> <code>sketch [OPTIONS] &lt;COMMAND&gt;</code></p>
<h6 id="subcommands"><a class="header" href="#subcommands"><strong>Subcommands:</strong></a></h6>
<ul>
<li><code>new</code> ‚Äî Generates a new config file</li>
<li><code>repo</code> ‚Äî Creates a new git repo from a preset</li>
<li><code>render</code> ‚Äî Renders a single template to a file or to stdout</li>
<li><code>render-preset</code> ‚Äî Renders a templating preset</li>
<li><code>exec</code> ‚Äî Renders a template and executes it as a shell command</li>
<li><code>gitignore</code> ‚Äî Generates a <code>.gitignore</code> file from a preset</li>
<li><code>gh-workflow</code> ‚Äî Generates a Github workflow</li>
<li><code>docker-compose</code> ‚Äî Generates a Docker Compose file from a preset</li>
<li><code>pre-commit</code> ‚Äî Generates a <code>pre-commit</code> config file from a preset</li>
<li><code>cargo-toml</code> ‚Äî Generates a <code>Cargo.toml</code> file from a preset</li>
<li><code>ts</code> ‚Äî Executes typescript-specific commands</li>
<li><code>package-json</code> ‚Äî Generates a <code>package.json</code> file from a preset</li>
<li><code>ts-config</code> ‚Äî Generates a <code>tsconfig.json</code> file from a preset</li>
<li><code>oxlint</code> ‚Äî Generates a <code>.oxlintrc.json</code> file from a preset</li>
<li><code>pnpm-workspace</code> ‚Äî Generates a <code>pnpm-workspace.yaml</code> file from a preset</li>
<li><code>license</code> ‚Äî Generates a license file</li>
</ul>
<h6 id="options"><a class="header" href="#options"><strong>Options:</strong></a></h6>
<ul>
<li><code>--print-config</code> ‚Äî Prints the full parsed config</li>
<li><code>--templates-dir &lt;DIR&gt;</code> ‚Äî The path to the templates directory</li>
<li><code>--no-overwrite</code> ‚Äî Do not overwrite existing files</li>
<li><code>-c</code>, <code>--config &lt;FILE&gt;</code> ‚Äî Sets a custom config file. Any file named <code>sketch.{yaml,json,toml}</code> in the cwd or in <code>XDG_CONFIG_HOME/sketch</code> will be detected automatically. If no file is found, the default settings are used</li>
<li><code>--ignore-config</code> ‚Äî Ignores any automatically detected config files, uses cli instructions and config file defined with --config</li>
<li><code>-s</code>, <code>--set &lt;KEY=VALUE&gt;</code> ‚Äî Sets a variable (as key=value) to use in templates. Overrides global and local variables. Values must be in valid JSON</li>
<li><code>--vars-file &lt;VARS_FILES&gt;</code> ‚Äî One or more paths to json, yaml or toml files to extract template variables from, in the given order</li>
</ul>
<h2 id="sketch-new"><a class="header" href="#sketch-new"><code>sketch new</code></a></h2>
<p>Generates a new config file</p>
<p><strong>Usage:</strong> <code>sketch new [OUTPUT]</code></p>
<h6 id="arguments"><a class="header" href="#arguments"><strong>Arguments:</strong></a></h6>
<ul>
<li><code>&lt;OUTPUT&gt;</code> ‚Äî The output file [default: sketch.yaml]</li>
</ul>
<h2 id="sketch-repo"><a class="header" href="#sketch-repo"><code>sketch repo</code></a></h2>
<p>Creates a new git repo from a preset</p>
<p><strong>Usage:</strong> <code>sketch repo [OPTIONS] [DIR]</code></p>
<h6 id="arguments-1"><a class="header" href="#arguments-1"><strong>Arguments:</strong></a></h6>
<ul>
<li><code>&lt;DIR&gt;</code> ‚Äî The directory where the new repo should be generated. [default: <code>.</code>]</li>
</ul>
<h6 id="options-1"><a class="header" href="#options-1"><strong>Options:</strong></a></h6>
<ul>
<li>
<p><code>-p</code>, <code>--preset &lt;PRESET&gt;</code> ‚Äî Selects a git preset from a configuration file</p>
</li>
<li>
<p><code>--no-pre-commit</code> ‚Äî Do not generate a pre-commit config</p>
</li>
<li>
<p><code>--pre-commit &lt;PRE_COMMIT&gt;</code> ‚Äî Selects a pre-commit preset</p>
</li>
<li>
<p><code>-g</code>, <code>--gitignore &lt;GITIGNORE&gt;</code> ‚Äî Selects a gitignore preset</p>
</li>
<li>
<p><code>-l</code>, <code>--license &lt;LICENSE&gt;</code> ‚Äî A license file to generate for the new repo</p>
<p>Possible values:</p>
<ul>
<li><code>apache2</code>:
Apache 2.0 license</li>
<li><code>gpl3</code>:
GNU GPL 3.0 license</li>
<li><code>agpl3</code>:
GNU AGPL 3.0 license</li>
<li><code>mit</code>:
MIT license</li>
</ul>
</li>
<li>
<p><code>-w</code>, <code>--with-template &lt;PRESET_ID|id=TEMPLATE_ID,output=PATH&gt;</code> ‚Äî One or many individual templates or templating presets to render in the new repo</p>
</li>
<li>
<p><code>--workflow &lt;id=PRESET_ID,file=PATH&gt;</code> ‚Äî One or many workflow presets to use for the new repo. The file path will be joined to <code>.github/workflows</code></p>
</li>
<li>
<p><code>-r</code>, <code>--remote &lt;REMOTE&gt;</code> ‚Äî The link of the git remote to use for the new repo</p>
</li>
</ul>
<h2 id="sketch-render"><a class="header" href="#sketch-render"><code>sketch render</code></a></h2>
<p>Renders a single template to a file or to stdout</p>
<p><strong>Usage:</strong> <code>sketch render [OPTIONS] &lt;OUTPUT_PATH|--stdout&gt;</code></p>
<h6 id="arguments-2"><a class="header" href="#arguments-2"><strong>Arguments:</strong></a></h6>
<ul>
<li><code>&lt;OUTPUT_PATH&gt;</code> ‚Äî The output path for the generated file</li>
</ul>
<h6 id="options-2"><a class="header" href="#options-2"><strong>Options:</strong></a></h6>
<ul>
<li><code>--stdout</code> ‚Äî Prints the result to stdout</li>
<li><code>-f</code>, <code>--file &lt;FILE&gt;</code> ‚Äî The path to the template file</li>
<li><code>-i</code>, <code>--id &lt;ID&gt;</code> ‚Äî The id of the template to use</li>
<li><code>-t</code>, <code>--template &lt;TEMPLATE&gt;</code> ‚Äî The path to a template file, starting from <code>templates_dir</code></li>
<li><code>-c</code>, <code>--content &lt;CONTENT&gt;</code> ‚Äî The literal definition for the template</li>
</ul>
<h2 id="sketch-render-preset"><a class="header" href="#sketch-render-preset"><code>sketch render-preset</code></a></h2>
<p>Renders a templating preset</p>
<p><strong>Usage:</strong> <code>sketch render-preset &lt;ID&gt; [OUT_DIR]</code></p>
<h6 id="arguments-3"><a class="header" href="#arguments-3"><strong>Arguments:</strong></a></h6>
<ul>
<li><code>&lt;ID&gt;</code> ‚Äî The id of the preset</li>
<li><code>&lt;OUT_DIR&gt;</code> ‚Äî The base path to join to relative output paths. [default: <code>.</code>]</li>
</ul>
<h2 id="sketch-exec"><a class="header" href="#sketch-exec"><code>sketch exec</code></a></h2>
<p>Renders a template and executes it as a shell command</p>
<p><strong>Usage:</strong> <code>sketch exec [OPTIONS] [CMD]</code></p>
<h6 id="arguments-4"><a class="header" href="#arguments-4"><strong>Arguments:</strong></a></h6>
<ul>
<li><code>&lt;CMD&gt;</code> ‚Äî The literal definition for the template (incompatible with <code>--file</code> or <code>--template</code>)</li>
</ul>
<h6 id="options-3"><a class="header" href="#options-3"><strong>Options:</strong></a></h6>
<ul>
<li><code>--print-cmd</code> ‚Äî Prints the rendered command to stdout before executing it</li>
<li><code>-s</code>, <code>--shell &lt;SHELL&gt;</code> ‚Äî The shell to use for commands [default: <code>cmd.exe</code> on windows and <code>sh</code> elsewhere]</li>
<li><code>--cwd &lt;CWD&gt;</code> ‚Äî The cwd for the command to execute [default: <code>.</code>]</li>
<li><code>-f</code>, <code>--file &lt;FILE&gt;</code> ‚Äî The path to the command's template file, as an absolute path or relative to the cwd</li>
<li><code>-t</code>, <code>--template &lt;TEMPLATE&gt;</code> ‚Äî The id of the template to use (a name for config-defined templates, or a relative path to a file from <code>templates_dir</code>)</li>
</ul>
<h2 id="sketch-gitignore"><a class="header" href="#sketch-gitignore"><code>sketch gitignore</code></a></h2>
<p>Generates a <code>.gitignore</code> file from a preset</p>
<p><strong>Usage:</strong> <code>sketch gitignore &lt;PRESET&gt; [OUTPUT]</code></p>
<h6 id="arguments-5"><a class="header" href="#arguments-5"><strong>Arguments:</strong></a></h6>
<ul>
<li><code>&lt;PRESET&gt;</code> ‚Äî The preset id</li>
<li><code>&lt;OUTPUT&gt;</code> ‚Äî The output path of the new file [default: <code>.gitignore</code>]</li>
</ul>
<h2 id="sketch-gh-workflow"><a class="header" href="#sketch-gh-workflow"><code>sketch gh-workflow</code></a></h2>
<p>Generates a Github workflow</p>
<p><strong>Usage:</strong> <code>sketch gh-workflow &lt;PRESET&gt; &lt;OUTPUT&gt;</code></p>
<h6 id="arguments-6"><a class="header" href="#arguments-6"><strong>Arguments:</strong></a></h6>
<ul>
<li><code>&lt;PRESET&gt;</code> ‚Äî The preset id</li>
<li><code>&lt;OUTPUT&gt;</code> ‚Äî The output path of the new file</li>
</ul>
<h2 id="sketch-docker-compose"><a class="header" href="#sketch-docker-compose"><code>sketch docker-compose</code></a></h2>
<p>Generates a Docker Compose file from a preset</p>
<p><strong>Usage:</strong> <code>sketch docker-compose [OPTIONS] &lt;PRESET&gt; [OUTPUT]</code></p>
<h6 id="arguments-7"><a class="header" href="#arguments-7"><strong>Arguments:</strong></a></h6>
<ul>
<li><code>&lt;PRESET&gt;</code> ‚Äî The preset id</li>
<li><code>&lt;OUTPUT&gt;</code> ‚Äî The output path of the new file [default: <code>compose.yaml</code>]</li>
</ul>
<h6 id="options-4"><a class="header" href="#options-4"><strong>Options:</strong></a></h6>
<ul>
<li><code>-S</code>, <code>--service &lt;SERVICES&gt;</code> ‚Äî id=PRESET,name=NAME|ID</li>
</ul>
<h2 id="sketch-pre-commit"><a class="header" href="#sketch-pre-commit"><code>sketch pre-commit</code></a></h2>
<p>Generates a <code>pre-commit</code> config file from a preset</p>
<p><strong>Usage:</strong> <code>sketch pre-commit &lt;PRESET&gt; [OUTPUT]</code></p>
<h6 id="arguments-8"><a class="header" href="#arguments-8"><strong>Arguments:</strong></a></h6>
<ul>
<li><code>&lt;PRESET&gt;</code> ‚Äî The preset id</li>
<li><code>&lt;OUTPUT&gt;</code> ‚Äî The output path of the new file [default: <code>.pre-commit-config.yaml</code>]</li>
</ul>
<h2 id="sketch-cargo-toml"><a class="header" href="#sketch-cargo-toml"><code>sketch cargo-toml</code></a></h2>
<p>Generates a <code>Cargo.toml</code> file from a preset</p>
<p><strong>Usage:</strong> <code>sketch cargo-toml [OPTIONS] &lt;PRESET&gt; [OUTPUT]</code></p>
<h6 id="arguments-9"><a class="header" href="#arguments-9"><strong>Arguments:</strong></a></h6>
<ul>
<li><code>&lt;PRESET&gt;</code> ‚Äî The preset id</li>
<li><code>&lt;OUTPUT&gt;</code> ‚Äî The output path of the new file [default: <code>Cargo.toml</code>]</li>
</ul>
<h6 id="options-5"><a class="header" href="#options-5"><strong>Options:</strong></a></h6>
<ul>
<li><code>-n</code>, <code>--name &lt;NAME&gt;</code> ‚Äî Sets the name of the package in the new file. Overrides the value in the preset</li>
</ul>
<h2 id="sketch-ts"><a class="header" href="#sketch-ts"><code>sketch ts</code></a></h2>
<p>Executes typescript-specific commands</p>
<p><strong>Usage:</strong> <code>sketch ts [OPTIONS] &lt;COMMAND&gt;</code></p>
<h6 id="subcommands-1"><a class="header" href="#subcommands-1"><strong>Subcommands:</strong></a></h6>
<ul>
<li><code>monorepo</code> ‚Äî Generates a new typescript monorepo</li>
<li><code>package</code> ‚Äî Generates a new typescript package</li>
<li><code>barrel</code> ‚Äî Creates a barrel file</li>
</ul>
<h6 id="options-6"><a class="header" href="#options-6"><strong>Options:</strong></a></h6>
<ul>
<li>
<p><code>--package-manager &lt;NAME&gt;</code> ‚Äî The package manager being used. [default: pnpm]</p>
<p>Possible values: <code>pnpm</code>, <code>npm</code>, <code>deno</code>, <code>bun</code>, <code>yarn</code></p>
</li>
<li>
<p><code>--no-default-deps &lt;NO_DEFAULT_DEPS&gt;</code> ‚Äî Do not add default dependencies to new <code>package.json</code> files (typescript and oxlint, plus vitest if enabled)</p>
<p>Possible values: <code>true</code>, <code>false</code></p>
</li>
<li>
<p><code>--version-range &lt;KIND&gt;</code> ‚Äî The kind of version range to use for dependencies that are fetched automatically. [default: minor]</p>
<p>Possible values: <code>minor</code>, <code>patch</code>, <code>exact</code></p>
</li>
<li>
<p><code>--catalog &lt;CATALOG&gt;</code> ‚Äî Uses the default catalog (supported by pnpm and bun) for default dependencies, and automatically adds dependencies marked with <code>catalog:</code> to the catalog, if they are missing</p>
<p>Possible values: <code>true</code>, <code>false</code></p>
</li>
<li>
<p><code>--no-convert-latest &lt;NO_CONVERT_LATEST_TO_RANGE&gt;</code> ‚Äî Do not convert dependencies marked as <code>latest</code> to a version range</p>
<p>Possible values: <code>true</code>, <code>false</code></p>
</li>
</ul>
<h2 id="sketch-ts-monorepo"><a class="header" href="#sketch-ts-monorepo"><code>sketch ts monorepo</code></a></h2>
<p>Generates a new typescript monorepo</p>
<p><strong>Usage:</strong> <code>sketch ts monorepo [OPTIONS] [DIR]</code></p>
<h6 id="arguments-10"><a class="header" href="#arguments-10"><strong>Arguments:</strong></a></h6>
<ul>
<li><code>&lt;DIR&gt;</code> ‚Äî The root directory for the new monorepo. [default: <code>ts_root</code>]</li>
</ul>
<h6 id="options-7"><a class="header" href="#options-7"><strong>Options:</strong></a></h6>
<ul>
<li>
<p><code>-p</code>, <code>--pnpm &lt;PRESET_ID&gt;</code> ‚Äî The <code>pnpm-workspace.yaml</code> preset to use for the new monorepo. If it's unset and <code>pnpm</code> is the chosen package manager, the default preset will be used</p>
</li>
<li>
<p><code>-r</code>, <code>--root-package &lt;PRESET_ID&gt;</code> ‚Äî The id of the package preset to use for the root package. If unset, the default preset is used, along with the values set via cli flags</p>
</li>
<li>
<p><code>-n</code>, <code>--name &lt;NAME&gt;</code> ‚Äî The name of the new package. It defaults to the name of its directory</p>
</li>
<li>
<p><code>--ts-config &lt;id=ID,output=PATH&gt;</code> ‚Äî One or many tsconfig presets (with their output path) to use for this package (uses defaults if not provided)</p>
</li>
<li>
<p><code>--package-json &lt;ID&gt;</code> ‚Äî The package.json preset ID to use (uses defaults if not provided)</p>
</li>
<li>
<p><code>--license &lt;LICENSE&gt;</code> ‚Äî A license file to generate for the new package</p>
<p>Possible values:</p>
<ul>
<li><code>apache2</code>:
Apache 2.0 license</li>
<li><code>gpl3</code>:
GNU GPL 3.0 license</li>
<li><code>agpl3</code>:
GNU AGPL 3.0 license</li>
<li><code>mit</code>:
MIT license</li>
</ul>
</li>
<li>
<p><code>--hook-pre &lt;ID&gt;</code> ‚Äî One or many IDs of templates to render and execute as commands before the package's creation</p>
</li>
<li>
<p><code>--hook-post &lt;ID&gt;</code> ‚Äî One or many IDs of templates to render and execute as commands after the package's creation</p>
</li>
<li>
<p><code>--oxlint &lt;ID&gt;</code> ‚Äî The oxlint preset to use. It can be set to <code>default</code> to use the default preset</p>
</li>
<li>
<p><code>-i</code>, <code>--install</code> ‚Äî Installs the dependencies with the chosen package manager</p>
</li>
<li>
<p><code>-w</code>, <code>--with-template &lt;PRESET_ID|id=TEMPLATE_ID,output=PATH&gt;</code> ‚Äî One or many templates or templating presets to generate in the new package's root</p>
</li>
</ul>
<h2 id="sketch-ts-package"><a class="header" href="#sketch-ts-package"><code>sketch ts package</code></a></h2>
<p>Generates a new typescript package</p>
<p><strong>Usage:</strong> <code>sketch ts package [OPTIONS] [DIR]</code></p>
<h6 id="arguments-11"><a class="header" href="#arguments-11"><strong>Arguments:</strong></a></h6>
<ul>
<li><code>&lt;DIR&gt;</code> ‚Äî The root directory for the new package. Defaults to the package name</li>
</ul>
<h6 id="options-8"><a class="header" href="#options-8"><strong>Options:</strong></a></h6>
<ul>
<li>
<p><code>-p</code>, <code>--preset &lt;ID&gt;</code> ‚Äî The package preset to use. If unset, the default preset is used, along with the values set via cli flags</p>
</li>
<li>
<p><code>-u</code>, <code>--update-tsconfig &lt;UPDATE_TSCONFIG&gt;</code> ‚Äî An optional list of tsconfig files where the new tsconfig file will be added as a reference</p>
</li>
<li>
<p><code>--oxlint &lt;ID&gt;</code> ‚Äî The oxlint preset to use. It can be set to <code>default</code> to use the default preset</p>
</li>
<li>
<p><code>-i</code>, <code>--install</code> ‚Äî Installs the dependencies with the chosen package manager</p>
</li>
<li>
<p><code>-w</code>, <code>--with-template &lt;PRESET_ID|id=TEMPLATE_ID,output=PATH&gt;</code> ‚Äî One or many templates or templating presets to generate in the new package's root</p>
</li>
<li>
<p><code>--vitest &lt;ID&gt;</code> ‚Äî The vitest preset to use. It can be set to <code>default</code> to use the default preset</p>
</li>
<li>
<p><code>-n</code>, <code>--name &lt;NAME&gt;</code> ‚Äî The name of the new package. It defaults to the name of its directory</p>
</li>
<li>
<p><code>--ts-config &lt;id=ID,output=PATH&gt;</code> ‚Äî One or many tsconfig presets (with their output path) to use for this package (uses defaults if not provided)</p>
</li>
<li>
<p><code>--package-json &lt;ID&gt;</code> ‚Äî The package.json preset ID to use (uses defaults if not provided)</p>
</li>
<li>
<p><code>--license &lt;LICENSE&gt;</code> ‚Äî A license file to generate for the new package</p>
<p>Possible values:</p>
<ul>
<li><code>apache2</code>:
Apache 2.0 license</li>
<li><code>gpl3</code>:
GNU GPL 3.0 license</li>
<li><code>agpl3</code>:
GNU AGPL 3.0 license</li>
<li><code>mit</code>:
MIT license</li>
</ul>
</li>
<li>
<p><code>--hook-pre &lt;ID&gt;</code> ‚Äî One or many IDs of templates to render and execute as commands before the package's creation</p>
</li>
<li>
<p><code>--hook-post &lt;ID&gt;</code> ‚Äî One or many IDs of templates to render and execute as commands after the package's creation</p>
</li>
</ul>
<h2 id="sketch-ts-barrel"><a class="header" href="#sketch-ts-barrel"><code>sketch ts barrel</code></a></h2>
<p>Creates a barrel file</p>
<p><strong>Usage:</strong> <code>sketch ts barrel [OPTIONS] [DIR]</code></p>
<h6 id="arguments-12"><a class="header" href="#arguments-12"><strong>Arguments:</strong></a></h6>
<ul>
<li><code>&lt;DIR&gt;</code> ‚Äî The directory where to search recursively for the files and generate the barrel file [default: <code>.</code>]</li>
</ul>
<h6 id="options-9"><a class="header" href="#options-9"><strong>Options:</strong></a></h6>
<ul>
<li><code>-o</code>, <code>--output &lt;OUTPUT&gt;</code> ‚Äî The output path for the barrel file. It defaults to <code>{dir}/index.ts</code></li>
<li><code>--keep-ext &lt;EXT&gt;</code> ‚Äî The file extensions that should be kept in export statements</li>
<li><code>--js-ext</code> ‚Äî Exports <code>.ts</code> files as <code>.js</code>. It assumes that <code>js</code> is among the file extensions to keep</li>
<li><code>--exclude &lt;EXCLUDE&gt;</code> ‚Äî One or more glob patterns to exclude from the imported modules</li>
</ul>
<h2 id="sketch-package-json"><a class="header" href="#sketch-package-json"><code>sketch package-json</code></a></h2>
<p>Generates a <code>package.json</code> file from a preset</p>
<p><strong>Usage:</strong> <code>sketch package-json &lt;PRESET&gt; [OUTPUT]</code></p>
<h6 id="arguments-13"><a class="header" href="#arguments-13"><strong>Arguments:</strong></a></h6>
<ul>
<li><code>&lt;PRESET&gt;</code> ‚Äî The preset id</li>
<li><code>&lt;OUTPUT&gt;</code> ‚Äî The output path of the generated file [default: <code>package.json</code>]</li>
</ul>
<h2 id="sketch-ts-config"><a class="header" href="#sketch-ts-config"><code>sketch ts-config</code></a></h2>
<p>Generates a <code>tsconfig.json</code> file from a preset</p>
<p><strong>Usage:</strong> <code>sketch ts-config &lt;PRESET&gt; [OUTPUT]</code></p>
<h6 id="arguments-14"><a class="header" href="#arguments-14"><strong>Arguments:</strong></a></h6>
<ul>
<li><code>&lt;PRESET&gt;</code> ‚Äî The preset id</li>
<li><code>&lt;OUTPUT&gt;</code> ‚Äî The output path of the generated file [default: <code>tsconfig.json</code>]</li>
</ul>
<h2 id="sketch-oxlint"><a class="header" href="#sketch-oxlint"><code>sketch oxlint</code></a></h2>
<p>Generates a <code>.oxlintrc.json</code> file from a preset</p>
<p><strong>Usage:</strong> <code>sketch oxlint &lt;PRESET&gt; [OUTPUT]</code></p>
<h6 id="arguments-15"><a class="header" href="#arguments-15"><strong>Arguments:</strong></a></h6>
<ul>
<li><code>&lt;PRESET&gt;</code> ‚Äî The preset id</li>
<li><code>&lt;OUTPUT&gt;</code> ‚Äî The output path of the generated file [default: <code>.oxlintrc.json</code>]</li>
</ul>
<h2 id="sketch-pnpm-workspace"><a class="header" href="#sketch-pnpm-workspace"><code>sketch pnpm-workspace</code></a></h2>
<p>Generates a <code>pnpm-workspace.yaml</code> file from a preset</p>
<p><strong>Usage:</strong> <code>sketch pnpm-workspace &lt;PRESET&gt; [OUTPUT]</code></p>
<h6 id="arguments-16"><a class="header" href="#arguments-16"><strong>Arguments:</strong></a></h6>
<ul>
<li><code>&lt;PRESET&gt;</code> ‚Äî The preset id</li>
<li><code>&lt;OUTPUT&gt;</code> ‚Äî The output path of the generated file [default: <code>pnpm-workspace.yaml</code>]</li>
</ul>
<h2 id="sketch-license"><a class="header" href="#sketch-license"><code>sketch license</code></a></h2>
<p>Generates a license file</p>
<p><strong>Usage:</strong> <code>sketch license [OPTIONS] &lt;LICENSE&gt;</code></p>
<h6 id="arguments-17"><a class="header" href="#arguments-17"><strong>Arguments:</strong></a></h6>
<ul>
<li>
<p><code>&lt;LICENSE&gt;</code></p>
<p>Possible values:</p>
<ul>
<li><code>apache2</code>:
Apache 2.0 license</li>
<li><code>gpl3</code>:
GNU GPL 3.0 license</li>
<li><code>agpl3</code>:
GNU AGPL 3.0 license</li>
<li><code>mit</code>:
MIT license</li>
</ul>
</li>
</ul>
<h6 id="options-10"><a class="header" href="#options-10"><strong>Options:</strong></a></h6>
<ul>
<li><code>-o</code>, <code>--output &lt;OUTPUT&gt;</code> ‚Äî The path of the output file [default: <code>LICENSE</code>]</li>
</ul>
<hr/>
<p><small><i>
This document was generated automatically by
<a href="https://crates.io/crates/clap-markdown"><code>clap-markdown</code></a>.
</i></small></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="configuration"><a class="header" href="#configuration">Configuration</a></h1>
<p>Sketch supports <code>yaml</code>, <code>json</code> and <code>toml</code> formats for its configuration file.</p>
<p>The strategy for detecting the configuration file works like this:</p>
<ul>
<li>If a file is manually specified with <code>--config</code>, that is used.</li>
<li>Any file named <code>sketch.{yaml, json, toml}</code> in the cwd is used.</li>
<li>Any file named <code>sketch.{yaml, json, toml}</code> in <code>XDG_CONFIG_HOME</code> or <code>$HOME/.config</code> is used.</li>
<li>No file detected, using default settings.</li>
</ul>
<p>Some of the values from configuration files can also be set via cli flags. When a value is set in a config file but also in a command, the value from the command has the higher priority.</p>
<p>You can also use the <code>--ignore-config</code> flag to temporarily ignore configuration files and only use cli-set values.</p>
<h2 id="generating-config-files"><a class="header" href="#generating-config-files">Generating Config Files</a></h2>
<p>You can use the <code>sketch new &lt;OUTPUT&gt;</code> command to generate a new configuration file in the desired output file and format (the default output is <code>sketch.yaml</code>).</p>
<h2 id="extending-configurations"><a class="header" href="#extending-configurations">Extending Configurations</a></h2>
<p>Configuration files can extend one another by using the <code>extends</code> field:</p>
<pre><code class="language-yaml">extends: ["other_config.yaml"]
</code></pre>
<p>Where the path being used can be either an absolute path or a relative path starting from the original config file.</p>
<p>The <a href="configuration/../presets/summary.html#extending-presets">merging strategy</a> for config files is the same as for all the other presets.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="lsp-integration"><a class="header" href="#lsp-integration">Lsp Integration</a></h1>
<p>In order to ensure the best development experience, it is highly recommended to set up your IDE to load the json schema for Sketch's configuration file.</p>
<p>This will provide type-safety, autocompletion and additional documentation when writing config files.</p>
<p>Every time a new version is released, the json schema for the configuration file will be updated in the <a href="https://github.com/Rick-Phoenix/sketch/tree/main/schemas">github repo</a>. Each version will have its own distinct schema file, and the <code>latest.json</code> file will track the schema for the latest version.</p>
<p>You can then use this schema with the <code>yaml</code>, <code>toml</code> or <code>json</code> language servers to get autocompletion, type information and documentation for each element of the config file.</p>
<p>This can be done by configuring the specific LSP in your editor, or simply by using a special comment at the top of your file that links to the config's json schema.</p>
<h2 id="examples"><a class="header" href="#examples">Examples</a></h2>
<p>Yaml:</p>
<pre><code class="language-yaml"># yaml-language-server: $schema=https://github.com/Rick-Phoenix/sketch/blob/main/schemas/latest.json
</code></pre>
<p>Json:</p>
<pre><code class="language-json">{
  "$schema": "https://github.com/Rick-Phoenix/sketch/blob/main/schemas/latest.json"
}
</code></pre>
<p>Toml:</p>
<pre><code class="language-toml">#:schema https://github.com/Rick-Phoenix/sketch/blob/main/schemas/latest.json
</code></pre>
<h1 id="external-configs"><a class="header" href="#external-configs">External Configs</a></h1>
<p>As of now, these external configurations defined with sketch are all <strong>fully typed and documented</strong>, so they benefit from the same lsp integration as the rest of the other settings:</p>
<ul>
<li><code>.pre-commit-config.yaml</code></li>
<li><code>.oxlintrc.json</code></li>
<li><code>pnpm-workspace.yaml</code></li>
<li><code>package.json</code></li>
<li><code>tsconfig.json</code></li>
<li><code>compose.yaml</code> (Docker)</li>
<li><a href="https://docs.github.com/en/actions/reference/workflows-and-actions/workflow-syntax">github workflows</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="templating"><a class="header" href="#templating">Templating</a></h1>
<p>Sketch uses the <a href="https://keats.github.io/tera/docs/">Tera</a> templating engine to render custom templates. Every template, whether it's defined in a file, in the config file, or inlined, can take advantage of all of Tera's functionalities, like using filters, functions, defining and using macros, performing operations and importing other templates.</p>
<div class="warning">
Since all autoescaping is disabled in templates, you should always only use templates that you made or trust.
</div>
<h2 id="context-and-variables"><a class="header" href="#context-and-variables">Context And Variables</a></h2>
<p>Each template can be populated with <code>context</code> variables. These variables can be set at many different stages, with different degrees of priority (from lowest to highest):</p>
<ul>
<li>Global variables</li>
<li>Cli-set variable files</li>
<li>Preset context</li>
<li>Single template context</li>
<li>Cli-set variables</li>
</ul>
<div class="warning">
Variables defined with the <code>--set</code> flag must be formatted in valid json. This means that, for example, strings must be wrapped in escaped quotes.
</div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="special-variables"><a class="header" href="#special-variables">Special Variables</a></h1>
<p>Sketch provides some special variables to get access to commonly used values such as the home directory.</p>
<p>All of the following variables are available in templates, prefixed with <code>sketch_</code> (i.e. <code>sketch_os</code> and so on).</p>
<ul>
<li><code>cwd</code></li>
<li><code>tmp_dir</code> (from <code>env::temp_dir</code>)</li>
<li><code>home</code> (from <code>env::home_dir</code>)</li>
<li><code>os</code> (from <code>CARGO_CFG_TARGET_OS</code> or env <code>OS</code>)</li>
<li><code>os_family</code> (from <code>CARGO_CFG_TARGET_FAMILY</code>)</li>
<li><code>arch</code> (from <code>CARGO_CFG_TARGET_ARCH</code> or env <code>HOSTTYPE</code>)</li>
<li><code>user</code> (env <code>USER</code>)</li>
<li><code>hostname</code> (env <code>HOSTNAME</code>)</li>
<li><code>xdg_config</code> (env <code>XDG_CONFIG_HOME</code>)</li>
<li><code>xdg_data</code> (env <code>XDG_DATA_HOME</code>)</li>
<li><code>xdg_state</code> (env <code>XDG_STATE_HOME</code>)</li>
<li><code>xdg_cache</code> (env <code>XDG_CACHE_HOME</code>)</li>
<li><code>is_unix</code> (from <code>cfg!(unix)</code>)</li>
<li><code>is_linux</code> (from <code>cfg!(target_os = "linux")</code>)</li>
<li><code>is_macos</code> (from <code>cfg!(target_os = "macos")</code>)</li>
<li><code>is_wsl</code> (checks <code>/proc/sys/kernel/osrelease</code>)</li>
<li><code>is_windows</code> (from <code>cfg!(windows)</code>)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="filters-and-functions"><a class="header" href="#filters-and-functions">Filters And Functions</a></h1>
<p>All of the builtin functionalities for <a href="https://keats.github.io/tera/docs/">Tera</a> are available.</p>
<p>On top of that, Sketch adds some extra filters and functions.</p>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<ul>
<li><code>uuid</code> (generates a v4 UUID)</li>
</ul>
<h2 id="filters"><a class="header" href="#filters">Filters</a></h2>
<h3 id="strings"><a class="header" href="#strings">Strings</a></h3>
<ul>
<li><code>capture(regex=REGEX)</code> (matches a regex once and returns the named capture groups)</li>
<li><code>capture_many(regex=REGEX)</code> (matches a regex repetitively and returns the list of named capture groups)</li>
<li><code>semver</code> (parses a cargo-style semver and returns the segments)</li>
<li><code>matches_semver(target=TARGET)</code> (checks if a cargo-style semver matches a target)</li>
<li><code>strip_prefix(prefix=PREFIX)</code> (strips a prefix from a string, if present)</li>
<li><code>strip_suffix(suffix=SUFFIX)</code> (strips a suffix from a string, if present)</li>
</ul>
<h3 id="filesystem"><a class="header" href="#filesystem">Filesystem</a></h3>
<ul>
<li><code>basename</code> (gets the basename of a directory/file)</li>
<li><code>parent_dir</code> (gets the parent directory of a directory/file)</li>
<li><code>is_file</code> (checks if a path is a file)</li>
<li><code>is_dir</code> (checks if a path is a directory)</li>
<li><code>is_absolute</code> (checks if a path is absolute)</li>
<li><code>is_relative</code> (checks if a path is relative)</li>
<li><code>absolute</code> (makes a path absolute)</li>
<li><code>relative(from=PATH)</code> (returns the relative path between two paths)</li>
<li><code>read_dir</code> (returns the list of the files contained in a directory and its subdirectories)</li>
<li><code>glob(pattern=GLOB)</code> (returns the glob matching entries in a directory and its subdirectories)</li>
<li><code>matches_glob(pattern=GLOB)</code> (checks if a path matches a glob pattern)</li>
</ul>
<h3 id="serialization"><a class="header" href="#serialization">Serialization</a></h3>
<ul>
<li><code>to_yaml</code> (serializes input into yaml)</li>
<li><code>to_toml</code> (serializes input into prettified toml)</li>
</ul>
<h2 id="examples-1"><a class="header" href="#examples-1">Examples</a></h2>
<p>Template:</p>
<pre><code class="language-jinja">{# Using special variables -#}

Current arch is: {{ sketch_arch }}
Current os is: {{ sketch_os }}
Current os family is: {{ sketch_os_family }}
Is unix: {{ sketch_is_unix }}

{# Functions and filters -#}

A random uuid is: {{ uuid() }}

{# Generating a random alphanumeric string -#}
A random string is: {{ uuid() | truncate(length=6, end="") }}

{# Generating a random number -#}
A random number is: {{ get_random(start=100000, end=9999999) }}

Now is {{ now(utc=true) }}

{# Assigning an env to a variable -#}
{%- set greeting = get_env(name="GREETING") -%}

{#- Manipulating data -#}
{%- set segments = greeting | split(pat=",") -%}
First segment is: {{ segments[0] }}
Second segment is: {{ segments[1] }}

{% set some_path = "mydir/myfile" -%}
Basename is: {{ some_path | basename }}
Parent dir is: {{ some_path | parent_dir }}

{% set dir = "../sketch" -%}

{% if dir | is_dir -%}
It's a dir!
{% endif -%}

{% set file = "Cargo.toml" -%}

{% if file | is_file -%}
It's a file!
{%- endif %}

Matches glob: {{ file | matches_glob(pattern="**/*.toml") }}

{%- set captures = file | capture(regex="(?&lt;path&gt;.*)\.(?&lt;extension&gt;\w+)") %}

Path is: {{ captures['path'] }}
Extension is: {{ captures['extension'] }}

In yaml form:
{{ captures | to_yaml }}

In toml form:
{{ captures | to_toml }}

{% set words = "They're taking the hobbits to Isengard" | capture_many(regex="(?&lt;word&gt;[\w']+)") -%}

{% for capture in words -%}
{{ capture['word'] -}} {% if not loop.last %}{{ " " }}{% endif -%}
{%- endfor -%}!

{% set version = "v0.1.0" -%}

{% set segments = version | semver -%}
Major is: {{ segments['major'] }}
Minor is: {{ segments['minor'] }}
Patch is: {{ segments['patch'] }}

Version matches &gt;=0.1.0: {{ version | matches_semver(target="&gt;=0.1.0") }}
Version matches &gt;=0.2.0: {{ version | matches_semver(target="&gt;=0.2.0") }}

To camelCase: {{ "my_var" | camel }}
To snake_case: {{ "myVar" | snake }}
To SCREAMING_CASE: {{ "myVar" | upper_snake }}
To PascalCase: {{ "myVar" | pascal }}

Luke, I am your {{ "grandfather" | strip_prefix(prefix="grand") }}!

{% set dir = "../examples/templating/templates" -%}

{% for entry in dir | glob(pattern="example.j2") -%}
Entry: {{ entry }}
{% endfor %}
</code></pre>
<p>Cmd:</p>
<blockquote>
<p><code>GREETING="hello,world" sketch render --template example.j2 --stdout</code></p>
</blockquote>
<p>Output:</p>
<pre><code>Current arch is: x86_64
Current os is: linux
Current os family is: unix
Is unix: true

A random uuid is: fd61daf5-83bf-46c6-afe3-5fcac0d6212c

A random string is: 0de4ed

A random number is: 3574820

Now is 2025-10-27T19:13:47.625250487+00:00

First segment is: hello
Second segment is: world

Basename is: myfile
Parent dir is: mydir

It's a dir!
It's a file!

Matches glob: true

Path is: Cargo
Extension is: toml

In yaml form:
path: Cargo
extension: toml


In toml form:
path = "Cargo"
extension = "toml"


They're taking the hobbits to Isengard!

Major is: 0
Minor is: 1
Patch is: 0

Version matches &gt;=0.1.0: true
Version matches &gt;=0.2.0: false

To camelCase: myVar
To snake_case: my_var
To SCREAMING_CASE: MY_VAR
To PascalCase: MyVar

Luke, I am your father!

Entry: example.j2
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rendering-a-template"><a class="header" href="#rendering-a-template">Rendering A Template</a></h1>
<p>We can render a template to a file or to stdout with the command <code>sketch render</code>.</p>
<h2 id="from-a-configuration-file"><a class="header" href="#from-a-configuration-file">From A Configuration File</a></h2>
<p>A template can be defined as simple text in a config file, inside the <code>templates</code> map. In this case, you can refer to this template by using its map key. This is the easiest method, but it also means slightly worse IDE integration for things like snippets and syntax highlighting.</p>
<pre><code class="language-yaml">templates_dir: templates

vars:
  location: Isengard
  greeting: hello
  general: kenobi
  meal: breakfast

templates:
  hobbits: "they're taking the hobbits to {{ location }}!"
  breakfast: "what about second {{ meal }}?"
</code></pre>
<p>Command:</p>
<blockquote>
<p><code>sketch render --id hobbits tests/output/custom_templates/from_template_id.txt</code></p>
</blockquote>
<h2 id="from-templates_dir"><a class="header" href="#from-templates_dir">From <code>templates_dir</code></a></h2>
<p>The best method is to use a file inside <code>templates_dir</code>. With this method, the template's ID becomes the relative path from <code>templates_dir</code>. This method provides better IDE integration if you have set up snippets or syntax highlighting for <code>jinja</code> files (Tera, the templating engine used by <code>sketch</code> is based on jinja).</p>
<h3 id="example"><a class="header" href="#example">Example</a></h3>
<p>Tree structure of <code>templates_dir</code>:</p>
<pre><code>‚îú‚îÄ‚îÄ example.j2
‚îî‚îÄ‚îÄ subdir
    ‚îú‚îÄ‚îÄ nested
    ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ more_nested_file.j2
    ‚îî‚îÄ‚îÄ nested_file.j2
</code></pre>
<p>Command:</p>
<blockquote>
<p><code>sketch render --template subdir/nested_file.j2 tests/output/custom_templates/from_template_file.txt</code></p>
</blockquote>
<blockquote>
<p>‚ÑπÔ∏è You can also use the <code>-f</code> flag to render a template from any file, even outside <code>templates_dir</code>.</p>
</blockquote>
<blockquote>
<p>‚ÑπÔ∏è <code>--id</code> and <code>--template</code> are aliases for one another, and they can be used to refer to a file inside <code>templates_dir</code>, or to a literal template in the config file.</p>
</blockquote>
<h2 id="from-literal-definition"><a class="header" href="#from-literal-definition">From Literal Definition</a></h2>
<p>Alternatively, a template can also be defined directly within a command:</p>
<blockquote>
<p><code>sketch render --content "they're taking the hobbits to {{ location }}!" tests/output/custom_templates/from_literal.txt</code></p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="executing-templates"><a class="header" href="#executing-templates">Executing Templates</a></h1>
<p>With the <code>sketch exec</code> command, you can render a template and then execute it as a shell command.</p>
<p>To do this, you can use a regular file, a template with an id (either defined in the config file or inside the <code>templates_dir</code>), or even one defined within the command itself.</p>
<h2 id="examples-2"><a class="header" href="#examples-2">Examples</a></h2>
<h3 id="from-template"><a class="header" href="#from-template">From Template</a></h3>
<p>Let's say that we have a file named <code>cmd_template.j2</code> inside our <code>templates_dir</code>, and it looks like this:</p>
<pre><code class="language-txt">echo "{{ category }} engine... {{ category }}... argh!" &gt; output_from_templates_dir.txt
</code></pre>
<blockquote>
<p>‚ÑπÔ∏è You do not have to use <code>.j2</code> as an extension for the template files. Any extension can be used.</p>
</blockquote>
<p>We can refer to it by its id:</p>
<blockquote>
<p><code>sketch --set category="gp2" tests/output/commands_tests -t cmd_template.j2</code></p>
</blockquote>
<p>This will trigger the command and create a file containing</p>
<pre><code class="language-txt">gp2 engine... gp2... argh!
</code></pre>
<h3 id="from-file"><a class="header" href="#from-file">From File</a></h3>
<p>We can also use a file that is not inside <code>templates_dir</code> by using the <code>-f</code> flag and providing the path to said file.  Relative paths will be resolved starting from the cwd.</p>
<p>So let's say that we have this template file:</p>
<pre><code class="language-txt">echo "all the time you have to leave the {{ something }}!" &gt; output_from_file.txt
</code></pre>
<p>Command:</p>
<blockquote>
<p><code>sketch --set something="space" tests/output/commands_tests -f tests/commands_tests/cmd_from_file.j2</code></p>
</blockquote>
<p>Output:</p>
<pre><code class="language-txt">all the time you have to leave the space!
</code></pre>
<h3 id="from-literal-template"><a class="header" href="#from-literal-template">From Literal Template</a></h3>
<p>Templates can also be defined directly as part of the command.</p>
<p>Command:</p>
<blockquote>
<p><code>sketch --set condition="slower" tests/output/commands_tests 'echo "engine feels good... much {{ condition }} than before... amazing" &gt; command_output.txt'</code></p>
</blockquote>
<p>Output:</p>
<pre><code class="language-txt">engine feels good... much slower than before... amazing
</code></pre>
<h2 id="hooks"><a class="header" href="#hooks">Hooks</a></h2>
<p>Templates can be executed as commands as <code>pre</code> or <code>post</code> hooks in a git <code>repo</code>, typecript <code>monorepo</code> or typescript <code>package</code> presets:</p>
<pre><code class="language-yaml">    # Commands to run before generation, from the root of the new project
    hooks_pre:
      - command:
          # Inlining a new template definition here,
          # but as always, we can use stored templates too
          name: pre_hook
          content: "echo '{{ greeting }}' &gt; pre.txt"
        context:
          greeting: hi

    # Commands to run after generation, from the root of the new project
    hooks_post:
      - command:
          name: post_hook
          content: "echo '{{ greeting }}' &gt; post.txt"
        context:
          greeting: hi
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="presets-1"><a class="header" href="#presets-1">Presets</a></h1>
<p>Sketch supports various kinds of presets, which are designed to serve different functionalities. Some presets serve as aggregators for other presets, others provide <a href="presets/summary.html#extending-presets">extensibility</a>, while others provide <a href="presets/../configuration/lsp.html">type safety</a> and lsp integration.</p>
<p>As of now, these presets are available:</p>
<ul>
<li>
<p>Templating</p>
<ul>
<li>Templating presets (extensible)</li>
</ul>
</li>
<li>
<p>Docker</p>
<ul>
<li>Docker Compose file (extensible)</li>
<li>Docker Compose service (extensible)</li>
</ul>
</li>
<li>
<p>Git</p>
<ul>
<li>Git repo</li>
<li><code>.gitignore</code> (extensible)</li>
<li><code>.pre-commit-config.yaml</code> (extensible)</li>
<li><a href="https://docs.github.com/en/actions/reference/workflows-and-actions/workflow-syntax">Github workflow</a> (extensible)</li>
<li><a href="https://docs.github.com/en/actions/reference/workflows-and-actions/workflow-syntax#jobs">Github workflow job</a> (extensible)</li>
<li><a href="https://docs.github.com/en/actions/reference/workflows-and-actions/workflow-syntax#jobsjob_idsteps">Github workflow step</a></li>
</ul>
</li>
<li>
<p>Rust</p>
<ul>
<li><code>Cargo.toml</code> (extensible, with merging of features for dependencies)</li>
</ul>
</li>
<li>
<p>Typescript</p>
<ul>
<li>Typescript package</li>
<li><code>pnpm-workspace.yaml</code> (extensible)</li>
<li><code>package.json</code> (extensible, with <a href="presets/../ts/smart_features.html">extra features</a>)</li>
<li><code>tsconfig.json</code> (extensible, with merging of values for the <code>references</code>, <code>include</code>, <code>exclude</code> and <code>files</code> fields)</li>
<li><code>.oxlintrc.json</code> (extensible)</li>
<li><code>vitest</code> (not a full configuration for <code>vitest.config.ts</code>, but a basic testing setup)</li>
</ul>
</li>
</ul>
<p>These can be generated individually, or as part of another preset. You can find more information about each command in the <a href="presets/../cli_docs.html">cli reference</a>.</p>
<h2 id="extending-presets"><a class="header" href="#extending-presets">Extending Presets</a></h2>
<p>Some presets can extend other presets. When a preset is extended, the merging strategy for their fields works like this:</p>
<ul>
<li>Collections are merged and, in almost all cases, also deduped and sorted (except for cases where order matters such as a list of command arguments). If the collection is a map and the values in it are also maps (as is the case for the <code>catalogs</code> field in <code>package.json</code> or <code>pnpm-workspace.yaml</code>), the inner maps will be merged.</li>
<li>Values that are also extensible (such as <code>compilerOptions</code> in a <code>tsconfig</code> preset) will be merged with the same rules as above</li>
<li>All other values are overwritten, except if the previous value was present and the new value is <code>null</code>. This is to avoid merging values that come from partially-defined presets, where the missing fields are all unset. Generally speaking, the correct strategy to extend presets is to define a base and then <code>add</code> elements to it, rather than replacing other values.</li>
</ul>
<h2 id="examples-3"><a class="header" href="#examples-3">Examples</a></h2>
<p>This is a detailed example of the various kinds of presets that are available:</p>
<pre><code class="language-yaml">
# `Cargo.toml` presets
cargo_toml_presets:
  base:
    package:
      version: "0.1.0"
      edition: "2024"

  cli-custom:
    extends_presets:
      - base
      - cli-tools
      - serde-ordered
    package:
      name: cli-custom
    dependencies:
      clap:
        features:
          - derive
      owo-colors:
        features:
          - supports-colors

  cli-tools:
    dependencies:
      ratatui: "0.29"
      clap: "4.5"
      serde: "1"
      owo-colors: "4"

  serde-ordered:
    dependencies:
      serde:
        version: "1"
        features:
          - preserve_order
      indexmap:
        version: "2.11"
        features:
          - serde

# Docker Compose presets
docker:
  service_presets:
    # A base service preset with common configurations
    base_service:
      environment:
        TZ: Europe/Berlin
      networks:
        - my_network

    # A preset for a db service
    database:
      extends_presets:
        - base_service
      image: postgres

    caddy:
      extends_presets:
        - base_service
      image: lucaslorentz/caddy-docker-proxy:ci-alpine
      networks:
        - my_network
      ports:
        - 80:80
        - 443:443

  compose_presets:
    # Base preset for a compose file
    base:
      volumes:
        my_volume:
          external: true
      networks:
        my_network:
          external: true

    extended:
      extends_presets:
        - base
      services:
        # Using the service preset by ID
        db: database
        my_service:
          networks:
            - my_network
          volumes:
            - my_volume:/target
      volumes:
        my_other_volume:
          external: true

# Gitignore presets
gitignore_presets:
  # Can be a string
  base:
    content: |
      *.env
      dist
  # Or a list of strings
  ts:
    extends_presets:
      # When being merged, the new entries are placed at the top
      - base
    content:
      - "*.tsBuildInfo"
      - node_modules

# Pre-commit presets
pre_commit_presets:
  # Commonly used repo
  base:
    repos:
      - repo: https://github.com/gitleaks/gitleaks
        rev: v8.28.0
        hooks:
          - id: gitleaks

  # Hooks specific to typescript projects
  typescript:
    # Extending the base preset
    extends_presets:
      - base
    repos:
      - repo: local
        hooks:
          - id: oxlint
            name: oxlint
            entry: oxlint
            language: system
            files: '\.svelte$|\.js$|\.ts$'
            types: [file]

# Git presets
git_presets:
  ts_package:
    workflows:
      - file_name: my_workflow.yaml
        # Preset ID
        id: extended
    # License file to generate
    license: Apache-2.0
    # Selecting a preset
    gitignore: ts
    pre_commit: typescript

    # Templates that will be generated with this preset
    # starting from the new repo's root
    with_templates:
      - id: dockerfile

    # Commands to run before generation, from the root of the new project
    hooks_pre:
      - command:
          # Inlining a new template definition here,
          # but as always, we can use stored templates too
          name: pre_hook
          content: "echo '{{ greeting }}' &gt; pre.txt"
        context:
          greeting: hi

    # Commands to run after generation, from the root of the new project
    hooks_post:
      - command:
          name: post_hook
          content: "echo '{{ greeting }}' &gt; post.txt"
        context:
          greeting: hi

typescript:
  # By default, typescript and oxlint are added to
  # the dependencies
  no_default_deps: true

  # By default, all versions marked with `latest` are converted to
  # a version range starting from the current version
  no_convert_latest_to_range: true

  # Version range to use when converting from `latest`
  version_range: patch

  # `pnpm-workspace.yaml` presets
  pnpm_presets:
    base:
      # All the dirs listed here will be created automatically
      # when new monorepos are created
      packages:
        - packages/*
        - apps/*
      onlyBuiltDependencies:
        - esbuild
      minimumReleaseAge: 1440

  # `package.json` presets
  package_json_presets:
    # Defining some reusable fields such as some common scripts and dependencies
    frontend:
      description: I am the base preset
      scripts:
        build: vite build
        dev: vite dev
      devDependencies:
        tailwindcss: "*"
        vite: "*"

    svelte_frontend:
      extends_presets: ["frontend"]
      # Adding new fields
      license: MIT
      # Overriding others
      description: I am the frontend preset
      # And merging dependencies
      devDependencies:
        svelte: "*"


  # Tsconfig presets
  ts_config_presets:
    base:
      references:
        - path: /some/path
      include:
        - src
      compilerOptions:
        noEmit: true
        verbatimModuleSyntax: true

    extended:
      extends_presets:
        - base
      # Unlike in real tsconfigs with `extends`, references are merged here,
      # and so are all other collections such as `files` or `include`.
      references:
        - path: /other/path
      include:
        - tests
      compilerOptions:
        # Whereas other fields are overwritten
        noEmit: false


  # Oxlint presets
  oxlint_presets:
    base:
      ignorePatterns:
        - "**/node_modules/**"

    extended:
      extends_presets:
        - base
      ignorePatterns:
        - .cache

  # Vitest presets
  vitest_presets:
    base:
      # Where the config file should be generated, starting from
      # the root of the package.
      # It defaults to the value of `tests_dir`
      out_dir: null

      # The directory to use for tests, from the root of the package
      tests_dir: tests

      # The directory, inside `tests_dir`, that contains the setup files for tests.
      # A file named `tests_setup.ts`, containing some basic testing boilerplate,
      # will be generated inside of it.
      setup_dir: setup

      # A list of setup files (the paths will be joined to the `setup_dir`)
      # `tests_setup.ts` will be added automatically.
      setup_files:
        - somefile.ts
        - anotherfile.ts
      environment: jsdom
      silent: passed-only


  # Package presets
  package_presets:
    example:
      name: example

      # For every preset, we can either refer to them
      # by their id...
      package_json: svelte_frontend

      # ...or we can inline a preset definition
      oxlint:
        extends_presets:
          - extended
        ignorePatterns:
          - .output

      # We can define one or many tsconfig files
      ts_config:
        # Can be omitted, would default to `tsconfig.json`
        - output: tsconfig.json
          config:
            # Once again creating a new config here with some extras
            extends_presets:
              - extended
            include:
              - scripts

      vitest: base

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="templating-presets"><a class="header" href="#templating-presets">Templating Presets</a></h1>
<p>Rendering a single template is for cases when we need a simpler or more flexible setup. But things become more interesting with <strong>templating presets</strong>, where different kinds of templates can be aggregated and used in order to define easily reproducible project structures.</p>
<p>Templating presets can be rendered with the <code>render-preset</code> command, or as part of <a href="presets/../presets/git.html#adding-templates">another preset</a>, such as a git repo preset.</p>
<p>A templating preset contains an optional context (which overrides the global context), and one or many of these items:</p>
<h3 id="1-individual-templates"><a class="header" href="#1-individual-templates">1. Individual Templates</a></h3>
<ul>
<li>Individual templates, which provide a manually controlled output path and their own local context</li>
</ul>
<h4 id="example-1"><a class="header" href="#example-1">Example</a></h4>
<pre><code class="language-yaml">templating_presets:

  lotr:
    # Group context, lower priority
    context: {}
    templates:
      # Selecting individual templates
      - template: hobbits
        output: hobbits.txt
        # Individual context, higher priority
        context: {}
      - template: breakfast
        output: subdir/breakfast.txt
</code></pre>
<p>Command:</p>
<blockquote>
<p><code>sketch render-preset lotr </code></p>
</blockquote>
<p>Tree output:</p>
<pre><code>‚îú‚îÄ‚îÄ hobbits.txt
‚îî‚îÄ‚îÄ subdir
    ‚îî‚îÄ‚îÄ breakfast.txt
</code></pre>
<h3 id="2-template-directory"><a class="header" href="#2-template-directory">2. Template Directory</a></h3>
<ul>
<li>A path to a directory inside <code>templates_dir</code>, where all templates will be recursively rendered in the output directory, with the same file tree structure</li>
</ul>
<blockquote>
<p>‚ÑπÔ∏è Any template files that end with the <code>.j2</code>, <code>.jinja</code> or <code>.jinja2</code> extensions will have them automatically removed. So <code>myfile.json.j2</code> will just become <code>myfile.json</code>.</p>
</blockquote>
<h4 id="example-2"><a class="header" href="#example-2">Example</a></h4>
<p>Let's say that this is our <code>templates_dir</code>:</p>
<pre><code>‚îú‚îÄ‚îÄ example.j2
‚îî‚îÄ‚îÄ subdir
    ‚îú‚îÄ‚îÄ nested
    ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ more_nested_file.j2
    ‚îî‚îÄ‚îÄ nested_file.j2
</code></pre>
<p>And we define this preset, which is meant to reproduce the entire file structure of <code>subdir</code> in the target directory.</p>
<pre><code class="language-yaml">templating_presets:
  structured:
    # Selecting all the files inside this directory
    # and its descendants
    templates:
      - dir: subdir
        # Glob patterns to exclude certain templates
        exclude:
          - "some/glob/pattern/*"
</code></pre>
<p>Command:</p>
<blockquote>
<p><code>sketch render-preset structured </code></p>
</blockquote>
<p>Tree output:</p>
<pre><code>‚îú‚îÄ‚îÄ nested
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ more_nested_file
‚îî‚îÄ‚îÄ nested_file
</code></pre>
<h3 id="3-remote-template"><a class="header" href="#3-remote-template">3. Remote Template</a></h3>
<ul>
<li>A special kind of template which points to a git repository. Every file inside of it will be rendered in the output directory.</li>
</ul>
<pre><code class="language-yaml">templating_presets:
  remote:
    templates:
      - repo: https://github.com/Rick-Phoenix/sketch-remote-preset-example
        # Glob patterns to exclude
        exclude: [.gitignore]
</code></pre>
<h4 id="example-3"><a class="header" href="#example-3">Example</a></h4>
<p>We start from this basic <a href="https://github.com/Rick-Phoenix/sketch-remote-preset-example">example</a></p>
<p>Command:</p>
<blockquote>
<p><code>sketch --set 'continuation="gp2 engine... gp2!"' render-preset remote </code></p>
</blockquote>
<p>Tree output:</p>
<pre><code>‚îú‚îÄ‚îÄ some_file
‚îî‚îÄ‚îÄ subdir
    ‚îî‚îÄ‚îÄ nested
        ‚îî‚îÄ‚îÄ nested_file
</code></pre>
<p>File output for <code>some_file</code>:</p>
<pre><code>Roses are red, violets are blue, gp2 engine... gp2!
</code></pre>
<h2 id="extending-templating-presets"><a class="header" href="#extending-templating-presets">Extending Templating Presets</a></h2>
<p>Templating presets are extensible. When a preset is being extended, its templates will be added to the receiving preset, and the two context maps will be merged, with the new context overwriting the previous context in case of conflicting variables.</p>
<pre><code class="language-yaml">  extended:
    extends_presets:
      - lotr
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="generating-a-git-repo"><a class="header" href="#generating-a-git-repo">Generating A Git Repo</a></h1>
<p>The <code>sketch repo</code> command allows you to generate a new git repository, starting from a preset stored in one of your configuration files.</p>
<p>A git preset uses (or defines) a preset for its <code>gitignore</code> file and, optionally, for <a href="https://pre-commit.com"><code>pre-commit</code></a>, as well as a list of templates that will be generated inside the root of the new repo when the command is triggered.</p>
<pre><code class="language-yaml"># Gitignore presets
gitignore_presets:
  # Can be a string
  base:
    content: |
      *.env
      dist
  # Or a list of strings
  ts:
    extends_presets:
      # When being merged, the new entries are placed at the top
      - base
    content:
      - "*.tsBuildInfo"
      - node_modules

# Pre-commit presets
pre_commit_presets:
  # Commonly used repo
  base:
    repos:
      - repo: https://github.com/gitleaks/gitleaks
        rev: v8.28.0
        hooks:
          - id: gitleaks

  # Hooks specific to typescript projects
  typescript:
    # Extending the base preset
    extends_presets:
      - base
    repos:
      - repo: local
        hooks:
          - id: oxlint
            name: oxlint
            entry: oxlint
            language: system
            files: '\.svelte$|\.js$|\.ts$'
            types: [file]

# Git presets
git_presets:
  ts_package:
    workflows:
      - file_name: my_workflow.yaml
        # Preset ID
        id: extended
    # License file to generate
    license: Apache-2.0
    # Selecting a preset
    gitignore: ts
    pre_commit: typescript
</code></pre>
<h2 id="adding-workflows"><a class="header" href="#adding-workflows">Adding Workflows</a></h2>
<p>We can also include some <a href="https://docs.github.com/en/actions/reference/workflows-and-actions">Github workflows</a> by using their presets:</p>
<pre><code class="language-yaml">    workflows:
      - file_name: my_workflow.yaml
        # Preset ID
        id: extended
</code></pre>
<h2 id="adding-templates"><a class="header" href="#adding-templates">Adding Templates</a></h2>
<p>We can use the <code>with_templates</code> setting to add a group of templates to a git preset. Let's say that we want to automatically generate a basic docker setup whenever we use this preset:</p>
<pre><code class="language-yaml"># We define a template in a file or in a config file...
templates:
  dockerfile: |
    FROM node:23-alpine

    COPY . .
    EXPOSE {{ docker_dev_port | default(value=5173) }}
    CMD ["npm", "run", "dev"]

# Templating presets
templating_presets:
  dockerfile:
    context:
      # Group context, lower priority
      docker_dev_port: 9530
    # List of templates
    templates:
      # Single template
      - output: Dockerfile
        template: dockerfile
        # Local context with higher priority
        context:
          docker_dev_port: 5173


# ...and then we add it to a preset

# Git presets
git_presets:
  ts_package:
    workflows:
      - file_name: my_workflow.yaml
        # Preset ID
        id: extended
    # License file to generate
    license: Apache-2.0
    # Selecting a preset
    gitignore: ts
    pre_commit: typescript

    # Templates that will be generated with this preset
    # starting from the new repo's root
    with_templates:
      - id: dockerfile
</code></pre>
<h2 id="hooks-1"><a class="header" href="#hooks-1">Hooks</a></h2>
<p>We can define some commands (which can also be templates) to execute before and/or after generating the new repo:</p>
<pre><code class="language-yaml">    # Commands to run before generation, from the root of the new project
    hooks_pre:
      - command:
          # Inlining a new template definition here,
          # but as always, we can use stored templates too
          name: pre_hook
          content: "echo '{{ greeting }}' &gt; pre.txt"
        context:
          greeting: hi

    # Commands to run after generation, from the root of the new project
    hooks_post:
      - command:
          name: post_hook
          content: "echo '{{ greeting }}' &gt; post.txt"
        context:
          greeting: hi
</code></pre>
<h2 id="example-4"><a class="header" href="#example-4">Example</a></h2>
<p>Starting from this config, we can run this command:</p>
<blockquote>
<p><code>sketch repo --preset ts_package </code></p>
</blockquote>
<p>To get this tree output:</p>
<pre><code>‚îú‚îÄ‚îÄ .github
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ workflows
‚îÇ¬†¬†     ‚îî‚îÄ‚îÄ my_workflow.yaml
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ .pre-commit-config.yaml
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ LICENSE
‚îú‚îÄ‚îÄ post.txt
‚îî‚îÄ‚îÄ pre.txt
</code></pre>
<blockquote>
<p>‚ÑπÔ∏è With cli flags, we can override the <code>gitignore</code> and <code>pre-commit</code> presets, as well as adding new templates or hooks to run or generate when the preset is being used.</p>
</blockquote>
<details>
<summary>pre-commit-config.yaml output</summary>
<pre><code class="language-yaml">repos:
- repo: local
  hooks:
  - id: oxlint
    entry: oxlint
    files: \.svelte$|\.js$|\.ts$
    language: system
    name: oxlint
    types:
    - file
- repo: https://github.com/gitleaks/gitleaks
  rev: v8.28.0
  hooks:
  - id: gitleaks
</code></pre>
</details>
<details>
<summary>gitignore output</summary>
<pre><code>*.tsBuildInfo
node_modules
*.env
dist
</code></pre>
</details>
<div style="break-before: page; page-break-before: always;"></div><h1 id="github-workflow-presets"><a class="header" href="#github-workflow-presets">Github Workflow Presets</a></h1>
<p>Sketch supports presets for <a href="https://docs.github.com/en/actions/reference/workflows-and-actions">Github workflows</a>, as well as individual components in a workflow, such as a job or a step.</p>
<h2 id="example-5"><a class="header" href="#example-5">Example</a></h2>
<p>We use this configuration:</p>
<pre><code class="language-yaml">github:
  workflow_presets:
    # Common settings for all workflows
    base:
      defaults:
        run:
          shell: bash
      env:
        my_env: somevalue
        another_env: anothervalue

    extended:
      extends_presets:
        - base
      on:
        push:
          branches:
            - main
      jobs:
        # Adding a job by using its preset ID
        check_main_branch: check_main_branch
        do_something:
          extends_presets:
            - base
          if: needs.check_branch.outputs.is_on_main == 'true'
          name: Do something while on main branch
          steps:
            - run: echo "Done something from main branch!"

  workflow_job_presets:
    # Common settings for all jobs
    base:
      runs-on: ubuntu-latest
      timeout-minutes: 25
      continue-on-error: false
      env:
        my_env: somevalue
        another_env: anothervalue

    check_main_branch:
      extends_presets:
        - base
      env:
        another_other_value: yetanothervalue
      outputs:
        is_on_main: ${{ steps.branch_check.outputs.is_on_main }}
      steps:
        # Using a step preset
        - check_main

  steps_presets:
    # Reusable step preset
    check_main:
      name: Check if a tag is on the main branch
      id: branch_check
      run: |
        if git branch -r --contains ${{ github.ref }} | grep -q 'origin/main'; then
        echo "On main branch. Proceeding with the workflow..."
        echo "is_on_main=true" &gt;&gt; "$GITHUB_OUTPUT"
        else
        echo "Not on main branch. Skipping workflow..."
        fi
</code></pre>
<p>Run the command</p>
<blockquote>
<p><code>sketch gh-workflow extended </code></p>
</blockquote>
<p>And get this output:</p>
<pre><code class="language-yaml">on:
  push:
    branches:
    - main
env:
  another_env: anothervalue
  my_env: somevalue
defaults:
  run:
    shell: bash
jobs:
  check_main_branch:
    runs-on: ubuntu-latest
    outputs:
      is_on_main: ${{ steps.branch_check.outputs.is_on_main }}
    env:
      another_env: anothervalue
      another_other_value: yetanothervalue
      my_env: somevalue
    timeout-minutes: 25
    continue-on-error: false
    steps:
    - name: Check if a tag is on the main branch
      id: branch_check
      run: |
        if git branch -r --contains ${{ github.ref }} | grep -q 'origin/main'; then
        echo "On main branch. Proceeding with the workflow..."
        echo "is_on_main=true" &gt;&gt; "$GITHUB_OUTPUT"
        else
        echo "Not on main branch. Skipping workflow..."
        fi
  do_something:
    runs-on: ubuntu-latest
    name: Do something while on main branch
    if: needs.check_branch.outputs.is_on_main == 'true'
    env:
      another_env: anothervalue
      my_env: somevalue
    timeout-minutes: 25
    continue-on-error: false
    steps:
    - run: echo "Done something from main branch!"
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cargotoml-presets"><a class="header" href="#cargotoml-presets">Cargo.toml Presets</a></h1>
<p>You can use sketch to define and generate extensible <code>Cargo.toml</code> presets.</p>
<p>When presets are extended, each dependency will also get merged according to the <a href="presets/./summary.html#extending-presets">merging rules</a>.</p>
<h2 id="example-6"><a class="header" href="#example-6">Example</a></h2>
<p>Config:</p>
<pre><code class="language-yaml">cargo_toml_presets:
  base:
    package:
      version: "0.1.0"
      edition: "2024"

  cli-custom:
    extends_presets:
      - base
      - cli-tools
      - serde-ordered
    package:
      name: cli-custom
    dependencies:
      clap:
        features:
          - derive
      owo-colors:
        features:
          - supports-colors

  cli-tools:
    dependencies:
      ratatui: "0.29"
      clap: "4.5"
      serde: "1"
      owo-colors: "4"

  serde-ordered:
    dependencies:
      serde:
        version: "1"
        features:
          - preserve_order
      indexmap:
        version: "2.11"
        features:
          - serde
</code></pre>
<p>Command:</p>
<blockquote>
<p><code>sketch cargo-toml cli-custom </code></p>
</blockquote>
<p>Output:</p>
<pre><code class="language-yaml">[package]
name = "cli-custom"
version = "0.1.0"
edition = "2024"

[dependencies]
ratatui = "0.29"

[dependencies.clap]
features = ["derive"]

[dependencies.indexmap]
features = ["serde"]

[dependencies.owo-colors]
features = ["supports-colors"]

[dependencies.serde]
features = ["preserve_order"]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="docker-compose-presets"><a class="header" href="#docker-compose-presets">Docker Compose Presets</a></h1>
<p>Sketch can be used to create extensible presets for entire compose files as well as individual services.</p>
<h2 id="example-7"><a class="header" href="#example-7">Example</a></h2>
<p>Config:</p>
<pre><code class="language-yaml">docker:
  service_presets:
    # A base service preset with common configurations
    base_service:
      environment:
        TZ: Europe/Berlin
      networks:
        - my_network

    # A preset for a db service
    database:
      extends_presets:
        - base_service
      image: postgres

    caddy:
      extends_presets:
        - base_service
      image: lucaslorentz/caddy-docker-proxy:ci-alpine
      networks:
        - my_network
      ports:
        - 80:80
        - 443:443

  compose_presets:
    # Base preset for a compose file
    base:
      volumes:
        my_volume:
          external: true
      networks:
        my_network:
          external: true

    extended:
      extends_presets:
        - base
      services:
        # Using the service preset by ID
        db: database
        my_service:
          networks:
            - my_network
          volumes:
            - my_volume:/target
      volumes:
        my_other_volume:
          external: true
</code></pre>
<p>Command:</p>
<blockquote>
<p><code>sketch docker-compose --service caddy extended </code></p>
</blockquote>
<blockquote>
<p>‚ÑπÔ∏è With the <code>--service</code> flag, extra service presets can be added to the output file.</p>
</blockquote>
<p>Output:</p>
<pre><code class="language-yaml">services:
  caddy:
    image: lucaslorentz/caddy-docker-proxy:ci-alpine
    environment:
      TZ: Europe/Berlin
    networks:
    - my_network
    ports:
    - 443:443
    - 80:80
  db:
    image: postgres
    environment:
      TZ: Europe/Berlin
    networks:
    - my_network
  my_service:
    networks:
    - my_network
    volumes:
    - my_volume:/target
networks:
  my_network:
    external: true
volumes:
  my_other_volume:
    external: true
  my_volume:
    external: true
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="typescript-presets"><a class="header" href="#typescript-presets">Typescript Presets</a></h1>
<p>Many typical components of a typescript project have their own dedicated preset.</p>
<h2 id="packagejson-presets"><a class="header" href="#packagejson-presets">Package.json Presets</a></h2>
<pre><code class="language-yaml">  package_json_presets:
    # Defining some reusable fields such as some common scripts and dependencies
    frontend:
      description: I am the base preset
      scripts:
        build: vite build
        dev: vite dev
      devDependencies:
        tailwindcss: "*"
        vite: "*"

    svelte_frontend:
      extends_presets: ["frontend"]
      # Adding new fields
      license: MIT
      # Overriding others
      description: I am the frontend preset
      # And merging dependencies
      devDependencies:
        svelte: "*"

</code></pre>
<p>Just like in actual <code>package.json</code> files, custom fields are allowed.</p>
<blockquote>
<p>‚ÑπÔ∏è <code>package.json</code> presets come with extra features. <a href="presets/../ts/smart_features.html">Dedicated section</a></p>
</blockquote>
<h2 id="tsconfig-presets"><a class="header" href="#tsconfig-presets">Tsconfig Presets</a></h2>
<pre><code class="language-yaml">  ts_config_presets:
    base:
      references:
        - path: /some/path
      include:
        - src
      compilerOptions:
        noEmit: true
        verbatimModuleSyntax: true

    extended:
      extends_presets:
        - base
      # Unlike in real tsconfigs with `extends`, references are merged here,
      # and so are all other collections such as `files` or `include`.
      references:
        - path: /other/path
      include:
        - tests
      compilerOptions:
        # Whereas other fields are overwritten
        noEmit: false

</code></pre>
<div class="warning">
<p>Unlike what happens when you merge two <code>tsconfig</code> files by using the <code>extends</code> field, extending presets will merge all collections, including <code>files</code>, <code>include</code>, <code>exclude</code> and <code>references</code>, which would normally be overwritten, rather than merged.</p>
</div>
<h2 id="oxlint-presets"><a class="header" href="#oxlint-presets">Oxlint Presets</a></h2>
<pre><code class="language-yaml">  oxlint_presets:
    base:
      ignorePatterns:
        - "**/node_modules/**"

    extended:
      extends_presets:
        - base
      ignorePatterns:
        - .cache
</code></pre>
<h2 id="pnpm-workspace-presets"><a class="header" href="#pnpm-workspace-presets">Pnpm-workspace Presets</a></h2>
<pre><code class="language-yaml">  pnpm_presets:
    base:
      # All the dirs listed here will be created automatically
      # when new monorepos are created
      packages:
        - packages/*
      onlyBuiltDependencies:
        - esbuild
      minimumReleaseAge: 1440
</code></pre>
<h2 id="vitest-presets"><a class="header" href="#vitest-presets">Vitest Presets</a></h2>
<pre><code class="language-yaml">  vitest_presets:
    base:
      # Where the config file should be generated, starting from
      # the root of the package.
      # It defaults to the value of `tests_dir`
      out_dir: null

      # The directory to use for tests, from the root of the package
      tests_dir: tests

      # The directory, inside `tests_dir`, that contains the setup files for tests.
      # A file named `tests_setup.ts`, containing some basic testing boilerplate,
      # will be generated inside of it.
      setup_dir: setup

      # A list of setup files (the paths will be joined to the `setup_dir`)
      # `tests_setup.ts` will be added automatically.
      setup_files:
        - somefile.ts
        - anotherfile.ts
      environment: jsdom
      silent: passed-only

</code></pre>
<h2 id="package-presets"><a class="header" href="#package-presets">Package Presets</a></h2>
<p>A package preset can be used to collect other presets, such as in this example:</p>
<pre><code class="language-yaml">  package_presets:
    example:
      name: example

      # For every preset, we can either refer to them
      # by their id...
      package_json: svelte_frontend

      # ...or we can inline a preset definition
      oxlint:
        extends_presets:
          - extended
        ignorePatterns:
          - .output

      # We can define one or many tsconfig files
      ts_config:
        # Can be omitted, would default to `tsconfig.json`
        - output: tsconfig.json
          config:
            # Once again creating a new config here with some extras
            extends_presets:
              - extended
            include:
              - scripts

      vitest: base
</code></pre>
<details>
<summary>Tsconfig output</summary>
<pre><code class="language-json">{
  "include": [
    "scripts",
    "src",
    "tests"
  ],
  "references": [
    {
      "path": "/other/path"
    },
    {
      "path": "/some/path"
    }
  ],
  "compilerOptions": {
    "noEmit": false,
    "verbatimModuleSyntax": true
  }
}
</code></pre>
</details>
<details>
<summary>Package.json output</summary>
<pre><code class="language-json">{
  "name": "example",
  "private": true,
  "version": "0.1.0",
  "type": "module",
  "scripts": {
    "build": "vite build",
    "dev": "vite dev"
  },
  "description": "I am the frontend preset",
  "license": "MIT",
  "packageManager": "pnpm",
  "dependencies": {},
  "devDependencies": {
    "svelte": "*",
    "tailwindcss": "*",
    "vite": "*"
  }
}
</code></pre>
</details>
<details>
<summary>Oxlintrc.json output</summary>
<pre><code class="language-json">{
  "plugins": [
    "oxc",
    "typescript",
    "unicorn"
  ],
  "ignorePatterns": [
    "**/node_modules/**",
    ".cache",
    ".output"
  ]
}
</code></pre>
</details>
<details>
<summary>vitest.config.ts output</summary>
<pre><code class="language-json">import { defineConfig } from "vitest/config";
import { resolve, join } from "node:path";

const j = join;
const r = resolve;

const dir = import.meta.dirname;
const setupDir = r(dir, "setup");

export default defineConfig({
  plugins: [],
  resolve: {
    alias: {
      '@': r(dir, "../src"),
    },
  },

  test: { 
    setupFiles: [ 
      j(setupDir, "tests_setup.ts"),
      j(setupDir, "somefile.ts"),
      j(setupDir, "anotherfile.ts")
    ], 
    globals: true,
    environment: "jsdom",
    silent: "passed-only",
    sequence: {
      setupFiles: "list",
    },
  },
});
</code></pre>
</details>
<div style="break-before: page; page-break-before: always;"></div><h1 id="smart-features"><a class="header" href="#smart-features">Smart Features</a></h1>
<p>Sketch provides some additional features that may come in handy when dealing with a typescript project.</p>
<h2 id="converting-latest-to-a-range"><a class="header" href="#converting-latest-to-a-range">Converting <code>latest</code> to a range</a></h2>
<p>By default, all versions marked as <code>latest</code> will be converted to a version range (<code>minor</code> by default, but can be customized) that starts from the actual latest version for that package.</p>
<p>This means that you can easily reuse your presets over time to start new projects, without needing to manually bump all versions, and while also avoiding <code>latest</code>, which is not suitable for stability.</p>
<div class="warning">
<p>Sketch uses the npm api to fetch the latest version for any given package. It sends a maximum of 10 parallel requests, but depending on how many requests are made in a given timeframe, you might still be rate limited by the api, causing an error.</p>
</div>
<pre><code class="language-yaml">typescript:
  # Default
  no_convert_latest_to_range: false

  # Default
  version_range: minor
</code></pre>
<h2 id="adding-dependencies-to-the-catalog"><a class="header" href="#adding-dependencies-to-the-catalog">Adding dependencies to the catalog</a></h2>
<p>If you set up your package manager to be <code>pnpm</code> (which is the default) or <code>bun</code> and set <code>catalog</code> to <code>true</code>, whenever you try to generate a new package that has dependencies marked with <code>catalog:</code>, each package that is not present in the target catalog (inside <code>pnpm-workspace.yaml</code> for pnpm, and inside <code>package.json</code> for bun) will be added automatically to it.</p>
<h3 id="example-8"><a class="header" href="#example-8">Example</a></h3>
<p>Let's say that we are starting with a basic <code>pnpm-workspace.yaml</code> config like this one:</p>
<pre><code class="language-yaml">  pnpm_presets:
    base:
      # All the dirs listed here will be created automatically
      # when new monorepos are created
      packages:
        - packages/*
      onlyBuiltDependencies:
        - esbuild
      minimumReleaseAge: 1440
</code></pre>
<p>and we generate a package that has <code>catalog</code> dependencies, which are currently absent from their target catalogs:</p>
<pre><code class="language-yaml">typescript:
  no_default_deps: true

  catalog: true

  # Default
  package_manager: pnpm

  package_presets:
    with_catalog:
      name: with_catalog
      package_json:
        devDependencies:
          # Named catalog
          svelte: catalog:svelte
          # Default catalog
          hono: "catalog:"
</code></pre>
<p>After running</p>
<blockquote>
<p><code>sketch ts package --preset with_catalog </code></p>
</blockquote>
<p>We can see that the pnpm-workspace.yaml file has been updated with the new named catalog and dependencies:</p>
<pre><code class="language-yaml">packages:
- packages/*
catalog:
  hono: ^4.10.3
catalogs:
  svelte:
    svelte: ^5.42.2
onlyBuiltDependencies:
- esbuild
minimumReleaseAge: 1440
</code></pre>
<h2 id="storing-and-reusing-contributors-data"><a class="header" href="#storing-and-reusing-contributors-data">Storing And Reusing Contributors' Data</a></h2>
<p>When working with a team on a monorepo that is made of several individual packages, it's very common that the same people have to be added to the <code>author</code>, <code>contributors</code> and <code>maintainers</code> fields in the <code>package.json</code> files for these packages.</p>
<p>To make this job a bit easier, you can use the <code>people</code> field in the typescript config to store information about contributors which you can then simply refer to by their ID.</p>
<h3 id="example-9"><a class="header" href="#example-9">Example</a></h3>
<pre><code class="language-yaml">typescript:
  no_default_deps: true

  people:
    # Person ID
    bruce:
      name: Bruce Wayne
      email: bruce@gotham.com
      url: brucewayne.com

  package_json_presets:
    people-example:
      author: bruce # Using the id from the store
      maintainers:
        # Literal definition
        - name: Clark Kent
          url: clarkkent.com
          email: clark-kent@dailyplanet.com
        - bruce
      contributors:
        - bruce

    # Since package.json presets are extensible,
    # you can use the above as a base for other package.json files,
    # if the author or contributors are always the same
    some-other-project:
      extends_presets:
        - people-example
      scripts:
        say-hi: echo hi!

  package_presets:
    people-example:
      package_json: people-example

</code></pre>
<p>After we run</p>
<blockquote>
<p><code>sketch ts package --preset people-example </code></p>
</blockquote>
<p>We get this <code>package.json</code> file in the root of the new package:</p>
<pre><code class="language-json">{
  "name": "people-example",
  "private": true,
  "version": "0.1.0",
  "type": "module",
  "scripts": {},
  "author": {
    "name": "Bruce Wayne",
    "email": "bruce@gotham.com",
    "url": "brucewayne.com"
  },
  "packageManager": "pnpm",
  "dependencies": {},
  "devDependencies": {},
  "contributors": [
    {
      "name": "Bruce Wayne",
      "email": "bruce@gotham.com",
      "url": "brucewayne.com"
    }
  ],
  "maintainers": [
    {
      "name": "Bruce Wayne",
      "email": "bruce@gotham.com",
      "url": "brucewayne.com"
    },
    {
      "name": "Clark Kent",
      "email": "clark-kent@dailyplanet.com",
      "url": "clarkkent.com"
    }
  ]
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="typescript-projects"><a class="header" href="#typescript-projects">Typescript Projects</a></h1>
<p>Sketch was initially conceived as a typescript-centric tool, as I needed a way to deal with the chaotic typescript ecosystem in a structured and easily reproducible way.</p>
<p>It supports a rich feature set dedicated to typescript, with dedicated <a href="ts/../presets/typescript.html">preset categories</a> (such as <code>tsconfig.json</code> and <code>package.json</code> presets) and <a href="ts/../cli_docs.html#sketch-ts">commands</a> (such as generating individual config files from presets, or generating barrel files).</p>
<p>These are the top level configuration settings for Typescript projects, with their default values:</p>
<pre><code class="language-yaml">typescript:
  # Convert `latest` to a version range for dependencies
  no_convert_latest_to_range: false

  # Use this kind of version range when converting from `latest`
  version_range: minor

  # Do not add default dependencies to new `package.json` files (typescript and oxlint, plus vitest if enabled)
  no_default_deps: false

  # Use the pnpm catalog for default dependencies
  # and add missing dependencies to it automatically
  catalog: false

  package_manager: pnpm

  # Configuration for the generated pnpm-workspace.yaml file
  pnpm:
    # All dirs listed here will be created automatically
    packages: ["packages/*"]

  # A map containing extensible package.json presets
  package_json_presets: {}

  # A map containing extensible package presets
  package_presets: {}

  # A map containing extensible tsconfig presets
  ts_config_presets: {}

  # A map containing extensible oxlint presets
  oxlint_presets: {}

  # A map of contributors and maintainers, which can be referenced
  # in `package.json` presets with their ID
  people: {}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="monorepo-generation"><a class="header" href="#monorepo-generation">Monorepo Generation</a></h1>
<p>To set up a basic monorepo with default settings, we can just run the command <code>sketch ts monorepo</code>. But we can also create a package preset and use that for the root package of the monorepo.</p>
<p>This is a more customized configuration for the root package:</p>
<pre><code class="language-yaml">typescript:
  # By default, typescript and oxlint would be added to
  # the root package's dependencies
  no_default_deps: true

  # Pnpm is the default, and if selected, it will generate
  # a pnpm-workspace.yaml file
  package_manager: pnpm

  pnpm_presets:
    base:
      # All the dirs listed here will be created automatically
      # when new monorepos are created
      packages:
        - packages/*
      onlyBuiltDependencies:
        - esbuild
      minimumReleaseAge: 1440

  package_presets:
    # Defining a preset for the root package
    root:
      name: workspace

      package_json:
        workspaces:
          # All dirs listed here are also created automatically
          # unless they contain '{', '[', '?' or '!'
          - apps/**/test
        license: Apache-2.0
        devDependencies:
          husky: ^9.0.0

      # The tsconfig files to generate at the root.
      # If left empty, defaults will be used.
      ts_config:
        - output: tsconfig.options.json
          config:
            compilerOptions:
              verbatimModuleSyntax: true
              strict: true

        - output: tsconfig.json
          config:
            files: []

      # Literal oxlint configuration to generate at the root
      # of the workspace.
      # Can be set to `true` to use defaults.
      oxlint:
        plugins: ["unicorn", "typescript", "oxc"]
</code></pre>
<h2 id="adding-templates-1"><a class="header" href="#adding-templates-1">Adding Templates</a></h2>
<p>You can also use the <code>with_templates</code> field to automatically generate a certain file structure when the monorepo is generated.</p>
<p>Let's say, for example, that every time that you create a new monorepo, you always want to create a <code>docker</code> directory with a basic <code>dev.dockerfile</code> inside of it, so that you can quickly create a dev environment using docker.</p>
<p>To do that, we add this to the root package's definition:</p>
<pre><code class="language-yaml">      with_templates:
        - templates:
            # Relative path from the root of the package
            - output: docker/dev.dockerfile
              template:
                name: dev_dockerfile
                content: |
                  FROM node:23-alpine

                  COPY . .
                  EXPOSE {{ docker_dev_port }}
                  CMD ["npm", "run", "dev"]

vars:
  docker_dev_port: 5173
</code></pre>
<blockquote>
<p>‚ÑπÔ∏è You can also use <code>--with-template &lt;PRESET_ID|id=TEMPLATE_ID,output=PATH&gt;</code> as a flag to add more templates or templating presets when generating a new package.</p>
</blockquote>
<h2 id="hooks-2"><a class="header" href="#hooks-2">Hooks</a></h2>
<p>We can define some commands (which can also be templates) to execute before and/or after generating the new monorepo:</p>
<pre><code class="language-yaml">    # Commands to run before generation, from the root of the new project
    hooks_pre:
      - command:
          # Inlining a new template definition here,
          # but as always, we can use stored templates too
          name: pre_hook
          content: "echo '{{ greeting }}' &gt; pre.txt"
        context:
          greeting: hi

    # Commands to run after generation, from the root of the new project
    hooks_post:
      - command:
          name: post_hook
          content: "echo '{{ greeting }}' &gt; post.txt"
        context:
          greeting: hi
</code></pre>
<h2 id="example-10"><a class="header" href="#example-10">Example</a></h2>
<p>So after setting everything up, we run the command</p>
<blockquote>
<p><code>sketch ts monorepo --root-package root --pnpm base </code></p>
</blockquote>
<p>And get this tree output:</p>
<pre><code>‚îú‚îÄ‚îÄ .oxlintrc.json
‚îú‚îÄ‚îÄ apps
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ test
‚îú‚îÄ‚îÄ docker
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ dev.dockerfile
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ packages
‚îú‚îÄ‚îÄ pnpm-workspace.yaml
‚îú‚îÄ‚îÄ tsconfig.json
‚îî‚îÄ‚îÄ tsconfig.options.json
</code></pre>
<blockquote>
<p>‚ÑπÔ∏è You can use the <code>-i</code> flag to install dependencies for the root package after creating the new monorepo.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="generating-a-package"><a class="header" href="#generating-a-package">Generating A Package</a></h1>
<p>You can use the command <code>sketch ts package</code> to generate a new Typescript package.</p>
<h2 id="hooks-3"><a class="header" href="#hooks-3">Hooks</a></h2>
<p>We can define some commands (which can also be templates) to execute before and/or after generating the new package:</p>
<pre><code class="language-yaml">    # Commands to run before generation, from the root of the new project
    hooks_pre:
      - command:
          # Inlining a new template definition here,
          # but as always, we can use stored templates too
          name: pre_hook
          content: "echo '{{ greeting }}' &gt; pre.txt"
        context:
          greeting: hi

    # Commands to run after generation, from the root of the new project
    hooks_post:
      - command:
          name: post_hook
          content: "echo '{{ greeting }}' &gt; post.txt"
        context:
          greeting: hi
</code></pre>
<h2 id="adding-templates-2"><a class="header" href="#adding-templates-2">Adding Templates</a></h2>
<p>You can also use the <code>with_templates</code> field (or the <code>--with-template</code> cli flag) to specify a list of templates or templating presets that should be generated whenever a package preset is being used.</p>
<p>Let's say for example that in a type of package, you always need a <code>schemas</code> directory, where you import some common schemas from a shared package and define new ones.</p>
<p>You can use this feature to generate a file inside <code>src/schemas/index.ts</code> automatically like this:</p>
<pre><code class="language-yaml">      # Inside the package preset configuration
      with_templates:
        # We can refer to a preset by id or create a new one locally
        - templates:
            - output: src/schemas/index.ts
              # This can be a template defined in the config file
              # or file path inside templates_dir
              template: schemas

templates:
  schemas: |
    import z from "zod";
    import { sharedSchemas } from "{{ schemas_package }}";

vars:
  schemas_package: "@myproject/schemas"
</code></pre>
<h2 id="example-11"><a class="header" href="#example-11">Example</a></h2>
<p>We start from this configuration:</p>
<pre><code class="language-yaml">typescript:
  # By default, typescript and oxlint are added to
  # the dependencies
  no_default_deps: true

  package_presets:
    frontend:
      # The name of the package. If this is unset,
      # the name of the output directory will be used.
      name: "@myproject/frontend"

      # The `package.json` config for this package. Can be a preset id
      # or a literal configuration.
      package_json:
        devDependencies:
          tailwindcss: "^4.0.0"

      # Generates an oxlint config file in the root.
      # Can be a boolean, a preset id, or
      # a literal configuration.
      oxlint: false

      # Create a vitest setup.
      # Can be a boolean, a preset id, or
      # a literal configuration.
      vitest:
        # Where the config file should be generated, starting from
        # the root of the package.
        # It defaults to the value of `tests_dir`
        out_dir: null

        # The directory to use for tests
        tests_dir: tests

        # The directory containing the setup files for tests.
        # (starting from tests_dir)
        setup_dir: setup

</code></pre>
<p>And then run</p>
<blockquote>
<p><code>sketch ts package --preset frontend </code></p>
</blockquote>
<p>To obtain this output in the designated directory:</p>
<pre><code>‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ src
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ index.ts
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ schemas
‚îÇ¬†¬†     ‚îî‚îÄ‚îÄ index.ts
‚îú‚îÄ‚îÄ tests
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ setup
‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ tests_setup.ts
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ vitest.config.ts
‚îî‚îÄ‚îÄ tsconfig.json
</code></pre>
<blockquote>
<p>‚ÑπÔ∏è You can also use the <code>-i</code> flag to automatically install the dependencies with your selected package manager whenever a new package is created.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="generating-a-barrel-file"><a class="header" href="#generating-a-barrel-file">Generating A Barrel File</a></h1>
<p>Sometimes it is useful to keep one or many barrel files in a typescript project, to make it easier to import/export elements from a group of modules.</p>
<p>Sketch has a dedicated command to make this process easier.</p>
<h2 id="examples-4"><a class="header" href="#examples-4">Examples</a></h2>
<p>Target directory:</p>
<pre><code>tests/ts_barrel
‚îî‚îÄ‚îÄ nested
    ‚îú‚îÄ‚îÄ file1.ts
    ‚îî‚îÄ‚îÄ nested2
        ‚îî‚îÄ‚îÄ file2.ts
</code></pre>
<p>Command:</p>
<blockquote>
<p><code>sketch ts barrel </code></p>
</blockquote>
<p>Output:</p>
<pre><code class="language-typescript">export * from "nested/file1";
export * from "nested/nested2/file2";
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>


    </div>
    </body>
</html>
